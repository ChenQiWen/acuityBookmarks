/**
 * 国际化字体定义 - Chrome扩展版
 * 使用@font-face + 相对路径，类似Icon字体的加载方式
 * 绕过CSP限制，实现按需字体切换
 */

/* ===========================================
 * 字体文件定义 (@font-face)
 * =========================================== */

/* NOTE: 本项目已将 Noto 字体外部化为 CDN 加载 + 运行时缓存方案。
   为避免在构建时将大体积字体打包到 dist 中，这里不再包含本地 @font-face 引用。
  字体加载与缓存已由 Service Worker 统一预取和缓存，不再依赖 fontLoader.ts。页面仅回退到下列 font-family 中声明的系统字体。
   如果 CDN 不可用，页面将回退到下列 font-family 中声明的系统字体。
*/

/* ===========================================
 * 动态字体变量系统
 * =========================================== */

:root {
  /* 默认字体：强制Noto字体优先 */
  --font-family-dynamic: 'Noto Sans', sans-serif;

  /* 语言字体变量（kebab-case，以满足 stylelint 对 custom-property-pattern 的要求） */
  --font-family-en:
    system-ui, -apple-system, segoe ui, roboto, ubuntu, cantarell, noto sans,
    helvetica neue, arial, sans-serif;
  --font-family-zh-cn:
    'Noto Sans SC', 'PingFang SC', 'Microsoft YaHei', 'WenQuanYi Micro Hei',
    'Heiti SC', sans-serif;
  --font-family-zh-tw:
    'Noto Sans TC', 'PingFang TC', 'Microsoft JhengHei', 'Heiti TC', sans-serif;
  --font-family-ja:
    'Noto Sans JP', 'Hiragino Kaku Gothic ProN', 'Meiryo', 'Yu Gothic',
    sans-serif;
  --font-family-ko:
    'Noto Sans KR', 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif;
  --font-family-ar:
    'Noto Sans Arabic', 'Geeza Pro', 'GeezaPro', arial, sans-serif;

  /* 西语、法语、德语、俄语等使用英文字体 */
  --font-family-es: var(--font-family-en);
  --font-family-fr: var(--font-family-en);
  --font-family-de: var(--font-family-en);
  --font-family-ru: var(--font-family-en);
}

/* ===========================================
 * 应用全局字体
 * =========================================== */

body,
html {
  font-family: var(--font-family-dynamic) !important;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;

  /* stylelint prefers lowercase value keywords */
  text-rendering: optimizelegibility;
}

/* 强制字体优先级 */
* {
  font-family: inherit;
}

/* 确保所有文本元素都使用指定字体 */
div,
span,
p,
h1,
h2,
h3,
h4,
h5,
h6,
button,
input,
textarea,
select,
label,
li,
td,
th,
a,
em,
strong,
small {
  font-family: inherit !important;
}

/* ===========================================
 * 语言特定样式类
 * =========================================== */

.font-en {
  font-family: var(--font-family-en) !important;
}

.font-zh-CN {
  font-family: var(--font-family-zh-cn) !important;
}

.font-zh-TW {
  font-family: var(--font-family-zh-tw) !important;
}

.font-ja {
  font-family: var(--font-family-ja) !important;
}

.font-ko {
  font-family: var(--font-family-ko) !important;
}

.font-ar {
  font-family: var(--font-family-ar) !important;
}

.font-es {
  font-family: var(--font-family-es) !important;
}

.font-fr {
  font-family: var(--font-family-fr) !important;
}

.font-de {
  font-family: var(--font-family-de) !important;
}

.font-ru {
  font-family: var(--font-family-ru) !important;
}

/* ===========================================
 * 基于语言属性的自动字体切换
 * =========================================== */

:lang(en) {
  font-family: var(--font-family-en);
}

:lang(zh-CN) {
  font-family: var(--font-family-zh-cn);
}

:lang(zh-TW) {
  font-family: var(--font-family-zh-tw);
}

:lang(ja) {
  font-family: var(--font-family-ja);
}

:lang(ko) {
  font-family: var(--font-family-ko);
}

:lang(ar) {
  font-family: var(--font-family-ar);
}

:lang(es) {
  font-family: var(--font-family-es);
}

:lang(fr) {
  font-family: var(--font-family-fr);
}

:lang(de) {
  font-family: var(--font-family-de);
}

:lang(ru) {
  font-family: var(--font-family-ru);
}

/* ===========================================
 * 字体预加载提示
 * =========================================== */

/* 通过CSS触发字体文件预加载 */
.font-preloader::before {
  position: absolute;
  left: -9999px;

  /* Add generic fallback to satisfy linters */
  font-family:
    'Noto Sans', 'Noto Sans SC', 'Noto Sans TC', 'Noto Sans JP', 'Noto Sans KR',
    'Noto Sans Arabic', sans-serif;
  opacity: 0;
  pointer-events: none;
  content: '';
}
