# å›½é™…åŒ–å·¥ä½œæµç¨‹

## ğŸ¯ å¿«é€Ÿå¼€å§‹

### å·¥å…·é“¾æ¦‚è§ˆ

```bash
# 1. æå–ç¡¬ç¼–ç æ–‡æ¡ˆï¼ˆåˆ†æï¼‰
bun run i18n:extract
# è¾“å‡º: i18n-report.json

# 2. è‡ªåŠ¨æ›¿æ¢æ–‡æ¡ˆï¼ˆä¿®æ”¹ä»£ç ï¼‰
bun run i18n:replace
# äº¤äº’å¼é€‰æ‹©è¦æ›¿æ¢çš„æ–‡æ¡ˆ

# 3. éªŒè¯ç¿»è¯‘å®Œæ•´æ€§ï¼ˆè´¨é‡æ£€æŸ¥ï¼‰
bun run i18n:validate
# æ£€æŸ¥æ‰€æœ‰è¯­è¨€åŒ…
```

---

## ğŸ“Š å½“å‰çŠ¶æ€

æ ¹æ®æœ€æ–°æ‰«æç»“æœï¼š

- **æ€»æ–‡ä»¶æ•°**: 301
- **ç¡¬ç¼–ç ä¸­æ–‡**: 6,906 å¤„
- **ç‹¬ç‰¹æ–‡æ¡ˆ**: 4,579 æ¡
- **ç°æœ‰ç¿»è¯‘é”®**: 28 ä¸ª
- **è¦†ç›–ç‡**: < 1%

**ç»“è®º**: éœ€è¦å¤§é‡å·¥ä½œï¼Œå»ºè®®åˆ†æ‰¹å¤„ç†ï¼

---

## ğŸ”„ æ¨èå·¥ä½œæµç¨‹

### é˜¶æ®µ 1: è¯•ç‚¹ï¼ˆç¬¬ 1 å‘¨ï¼‰

**ç›®æ ‡**: ç†Ÿæ‚‰å·¥å…·ï¼Œå®Œæˆæ ¸å¿ƒæ¨¡å—

#### Step 1: æå–æ–‡æ¡ˆ

```bash
cd frontend
bun run i18n:extract
```

æŸ¥çœ‹ç”Ÿæˆçš„ `i18n-report.json`ï¼Œäº†è§£æ–‡æ¡ˆåˆ†å¸ƒã€‚

#### Step 2: é€‰æ‹©ä¼˜å…ˆæ¨¡å—

æ ¹æ®æŠ¥å‘Šï¼Œä¼˜å…ˆå¤„ç†ï¼š

1. **ç”¨æˆ·å¯è§çš„ UI æ–‡æ¡ˆ** (é«˜ä¼˜å…ˆçº§)
   - æŒ‰é’®æ–‡æœ¬
   - é”™è¯¯æç¤º
   - æˆåŠŸæ¶ˆæ¯
   - è¡¨å•æ ‡ç­¾

2. **æ—¥å¿—å’Œè°ƒè¯•ä¿¡æ¯** (ä½ä¼˜å…ˆçº§)
   - console.log
   - logger.debug
   - æ³¨é‡Šä¸­çš„ä¸­æ–‡

**å»ºè®®**: å…ˆå¤„ç† UI æ–‡æ¡ˆï¼Œæ—¥å¿—å¯ä»¥ä¿æŒä¸­æ–‡ã€‚

#### Step 3: æ‰‹åŠ¨æ›¿æ¢ï¼ˆå°èŒƒå›´è¯•ç‚¹ï¼‰

é€‰æ‹© 1-2 ä¸ªå°æ–‡ä»¶æ‰‹åŠ¨æ›¿æ¢ï¼Œç†Ÿæ‚‰æµç¨‹ï¼š

```vue
<!-- ä¹‹å‰ -->
<template>
  <button>ä¿å­˜</button>
  <p>{{ errorMessage }}</p>
</template>

<script setup>
const errorMessage = ref('ä¿å­˜å¤±è´¥')
</script>

<!-- ä¹‹å -->
<template>
  <button>{{ t('common.save') }}</button>
  <p>{{ t(errorKey) }}</p>
</template>

<script setup>
import { useI18n } from '@/utils/i18n-helpers'

const { t } = useI18n()
const errorKey = ref('error.save_failed')
</script>
```

åŒæ—¶æ›´æ–° `_locales/zh_CN/messages.json`:

```json
{
  "common.save": {
    "message": "ä¿å­˜",
    "description": "é€šç”¨ä¿å­˜æŒ‰é’®"
  },
  "error.save_failed": {
    "message": "ä¿å­˜å¤±è´¥",
    "description": "ä¿å­˜æ“ä½œå¤±è´¥çš„é”™è¯¯æç¤º"
  }
}
```

#### Step 4: æµ‹è¯•éªŒè¯

```bash
# ç±»å‹æ£€æŸ¥
bun run typecheck

# ä»£ç è§„èŒƒ
bun run lint

# ç¿»è¯‘éªŒè¯
bun run i18n:validate

# æ‰‹åŠ¨æµ‹è¯•
bun run dev
```

#### Step 5: æäº¤ä»£ç 

```bash
git add .
git commit -m "feat(i18n): å®Œæˆ XX æ¨¡å—çš„å›½é™…åŒ–"
```

---

### é˜¶æ®µ 2: æ‰¹é‡å¤„ç†ï¼ˆç¬¬ 2-3 å‘¨ï¼‰

**ç›®æ ‡**: ä½¿ç”¨è‡ªåŠ¨åŒ–å·¥å…·æ‰¹é‡å¤„ç†

#### Step 1: è¿è¡Œè‡ªåŠ¨æ›¿æ¢å·¥å…·

```bash
bun run i18n:replace
```

**äº¤äº’å¼é€‰æ‹©**:

```
ğŸ“ å‘ç° 4579 æ¡ç¡¬ç¼–ç æ–‡æ¡ˆ

é€‰æ‹©å¤„ç†æ–¹å¼:
  1. å¤„ç†å‰ 50 æ¡ï¼ˆæ¨èï¼‰
  2. å¤„ç†å‰ 100 æ¡
  3. å¤„ç†å…¨éƒ¨ï¼ˆè°¨æ…ï¼ï¼‰
  4. æ‰‹åŠ¨é€‰æ‹©èŒƒå›´
  0. é€€å‡º

è¯·é€‰æ‹© (0-4): 1
```

**å»ºè®®**: 
- ç¬¬ä¸€æ¬¡é€‰æ‹© "1" (50æ¡)
- æµ‹è¯•é€šè¿‡åï¼Œé€æ­¥å¢åŠ åˆ° 100ã€200 æ¡
- **ä¸è¦ä¸€æ¬¡æ€§å¤„ç†å…¨éƒ¨ï¼**

#### Step 2: å®¡æŸ¥è‡ªåŠ¨ç”Ÿæˆçš„ä»£ç 

å·¥å…·ä¼šï¼š

1. âœ… åœ¨ `_locales/*/messages.json` ä¸­æ·»åŠ ç¿»è¯‘é”®
2. âœ… åœ¨ä»£ç ä¸­æ·»åŠ  `import { t } from '@/utils/i18n-helpers'`
3. âœ… æ›¿æ¢ç¡¬ç¼–ç æ–‡æ¡ˆä¸º `t('key')`

**ä½ éœ€è¦æ£€æŸ¥**:

- [ ] ç¿»è¯‘é”®å‘½åæ˜¯å¦åˆç†
- [ ] æ›¿æ¢æ˜¯å¦æ­£ç¡®ï¼ˆæ²¡æœ‰è¯¯ä¼¤ï¼‰
- [ ] import è¯­å¥æ˜¯å¦æ­£ç¡®
- [ ] ä»£ç æ ¼å¼æ˜¯å¦æ­£å¸¸

#### Step 3: ä¼˜åŒ–ç¿»è¯‘é”®

è‡ªåŠ¨ç”Ÿæˆçš„é”®å¯èƒ½ä¸å¤Ÿå¥½ï¼Œæ‰‹åŠ¨ä¼˜åŒ–ï¼š

```json
// âŒ è‡ªåŠ¨ç”Ÿæˆï¼ˆä¸å¤Ÿè¯­ä¹‰åŒ–ï¼‰
{
  "messaging.æ¶ˆæ¯ç±»å‹": { "message": "æ¶ˆæ¯ç±»å‹" },
  "messaging.å¯é€‰çš„æ¶ˆæ¯æ•°æ®": { "message": "å¯é€‰çš„æ¶ˆæ¯æ•°æ®" }
}

// âœ… æ‰‹åŠ¨ä¼˜åŒ–ï¼ˆæ›´æ¸…æ™°ï¼‰
{
  "messaging.message_type": { "message": "æ¶ˆæ¯ç±»å‹" },
  "messaging.optional_data": { "message": "å¯é€‰çš„æ¶ˆæ¯æ•°æ®" }
}
```

#### Step 4: è¡¥å…¨å…¶ä»–è¯­è¨€ç¿»è¯‘

ä½¿ç”¨ AI è¾…åŠ©ç¿»è¯‘ï¼š

**Prompt æ¨¡æ¿**:

```
è¯·å°†ä»¥ä¸‹ Chrome Extension çš„ä¸­æ–‡ç¿»è¯‘ä¸ºè‹±æ–‡ã€‚
ä¿æŒ JSON æ ¼å¼ï¼Œåªç¿»è¯‘ "message" å­—æ®µçš„å€¼ã€‚

{
  "common.save": { "message": "ä¿å­˜" },
  "common.cancel": { "message": "å–æ¶ˆ" },
  "error.save_failed": { "message": "ä¿å­˜å¤±è´¥" }
}
```

**AI è¾“å‡º**:

```json
{
  "common.save": { "message": "Save" },
  "common.cancel": { "message": "Cancel" },
  "error.save_failed": { "message": "Save failed" }
}
```

å¤åˆ¶åˆ° `_locales/en/messages.json`ã€‚

#### Step 5: éªŒè¯å’Œæµ‹è¯•

```bash
# éªŒè¯ç¿»è¯‘å®Œæ•´æ€§
bun run i18n:validate

# ç±»å‹æ£€æŸ¥
bun run typecheck

# ä»£ç è§„èŒƒ
bun run lint

# æ‰‹åŠ¨æµ‹è¯•ï¼ˆåˆ‡æ¢è¯­è¨€ï¼‰
# åœ¨æµè§ˆå™¨ä¸­æµ‹è¯•ä¸åŒè¯­è¨€
```

---

### é˜¶æ®µ 3: å®Œå–„å’Œç»´æŠ¤ï¼ˆç¬¬ 4 å‘¨+ï¼‰

#### æ—¥å¸¸å¼€å‘è§„èŒƒ

**æ–°åŠŸèƒ½å¼€å‘æ—¶**:

```vue
<!-- âŒ ç¦æ­¢ç¡¬ç¼–ç  -->
<template>
  <button>ä¿å­˜</button>
</template>

<!-- âœ… ä½¿ç”¨ç¿»è¯‘é”® -->
<template>
  <button>{{ t('common.save') }}</button>
</template>

<script setup>
import { useI18n } from '@/utils/i18n-helpers'
const { t } = useI18n()
</script>
```

**æ·»åŠ æ–°æ–‡æ¡ˆæ—¶**:

1. åœ¨ `_locales/zh_CN/messages.json` æ·»åŠ ä¸­æ–‡
2. åœ¨ `_locales/en/messages.json` æ·»åŠ è‹±æ–‡
3. å…¶ä»–è¯­è¨€å¯ä»¥å…ˆç”¨ `[TODO]` å ä½
4. å®šæœŸæ‰¹é‡ç¿»è¯‘

#### å®šæœŸæ£€æŸ¥

```bash
# æ¯å‘¨è¿è¡Œä¸€æ¬¡
bun run i18n:extract   # æ£€æŸ¥æ–°å¢çš„ç¡¬ç¼–ç 
bun run i18n:validate  # æ£€æŸ¥ç¿»è¯‘å®Œæ•´æ€§
```

#### CI/CD é›†æˆ

åœ¨ `.github/workflows/i18n-check.yml`:

```yaml
name: I18n Check

on: [pull_request]

jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: oven-sh/setup-bun@v1
      - run: cd frontend && bun install
      - run: cd frontend && bun run i18n:validate
```

---

## ğŸ¯ ä¼˜å…ˆçº§å»ºè®®

### P0 - å¿…é¡»ç¿»è¯‘ï¼ˆç”¨æˆ·å¯è§ï¼‰

- [ ] å¯¼èˆªèœå•
- [ ] æŒ‰é’®æ–‡æœ¬
- [ ] é”™è¯¯æç¤º
- [ ] æˆåŠŸæ¶ˆæ¯
- [ ] è¡¨å•æ ‡ç­¾
- [ ] å ä½ç¬¦æ–‡æœ¬
- [ ] Toast é€šçŸ¥

### P1 - åº”è¯¥ç¿»è¯‘ï¼ˆé‡è¦ä½†ä¸ç´§æ€¥ï¼‰

- [ ] è®¾ç½®é¡µé¢
- [ ] å¸®åŠ©æ–‡æ¡£
- [ ] Tooltip æç¤º
- [ ] ç¡®è®¤å¯¹è¯æ¡†
- [ ] ç©ºçŠ¶æ€æç¤º

### P2 - å¯ä»¥ç¿»è¯‘ï¼ˆé”¦ä¸Šæ·»èŠ±ï¼‰

- [ ] è¯¦ç»†è¯´æ˜æ–‡æœ¬
- [ ] ç¤ºä¾‹æ–‡æœ¬
- [ ] å¼€å‘è€…å·¥å…·æç¤º

### P3 - ä¸éœ€è¦ç¿»è¯‘ï¼ˆä¿æŒä¸­æ–‡ï¼‰

- [ ] ä»£ç æ³¨é‡Š
- [ ] console.log è°ƒè¯•ä¿¡æ¯
- [ ] logger.debug æ—¥å¿—
- [ ] å¼€å‘æ–‡æ¡£

---

## ğŸ“ ç¿»è¯‘é”®å‘½åè§„èŒƒ

### æ ¼å¼

```
<æ¨¡å—>.<åŠŸèƒ½>.<ç±»å‹>
```

### ç¤ºä¾‹

```json
{
  // é€šç”¨
  "common.save": { "message": "ä¿å­˜" },
  "common.cancel": { "message": "å–æ¶ˆ" },
  "common.confirm": { "message": "ç¡®è®¤" },
  
  // ä¾§è¾¹æ 
  "sidebar.bookmarks.title": { "message": "ä¹¦ç­¾ç®¡ç†" },
  "sidebar.recent.title": { "message": "æœ€è¿‘è®¿é—®" },
  
  // é”™è¯¯æ¶ˆæ¯
  "error.network.timeout": { "message": "ç½‘ç»œè¶…æ—¶" },
  "error.save.failed": { "message": "ä¿å­˜å¤±è´¥" },
  
  // æˆåŠŸæ¶ˆæ¯
  "success.bookmark.created": { "message": "ä¹¦ç­¾åˆ›å»ºæˆåŠŸ" },
  "success.bookmark.deleted": { "message": "ä¹¦ç­¾åˆ é™¤æˆåŠŸ" }
}
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. ä¸è¦ä¸€æ¬¡æ€§å¤„ç†å…¨éƒ¨

```bash
# âŒ å±é™©
bun run i18n:replace
# é€‰æ‹© "3. å¤„ç†å…¨éƒ¨"

# âœ… å®‰å…¨
bun run i18n:replace
# é€‰æ‹© "1. å¤„ç†å‰ 50 æ¡"
# æµ‹è¯•é€šè¿‡åå†ç»§ç»­
```

### 2. ä»”ç»†å®¡æŸ¥è‡ªåŠ¨ç”Ÿæˆçš„ä»£ç 

è‡ªåŠ¨æ›¿æ¢å¯èƒ½ä¼šï¼š

- âŒ è¯¯ä¼¤æ³¨é‡Šä¸­çš„ä¸­æ–‡
- âŒ è¯¯ä¼¤å­—ç¬¦ä¸²æ‹¼æ¥
- âŒ è¯¯ä¼¤æ­£åˆ™è¡¨è¾¾å¼
- âŒ ç”Ÿæˆä¸åˆç†çš„é”®å

**åŠ¡å¿…äººå·¥å®¡æŸ¥ï¼**

### 3. æäº¤å‰æ£€æŸ¥

```bash
# å¿…é¡»å…¨éƒ¨é€šè¿‡
bun run typecheck  # âœ…
bun run lint       # âœ…
bun run i18n:validate  # âœ…

# æ‰‹åŠ¨æµ‹è¯•
# âœ… åˆ‡æ¢è¯­è¨€æµ‹è¯•
# âœ… åŠŸèƒ½æ­£å¸¸
# âœ… UI æ˜¾ç¤ºæ­£å¸¸
```

### 4. åˆ†æ‰¹æäº¤

```bash
# âœ… å¥½çš„æäº¤
git commit -m "feat(i18n): å®Œæˆä¾§è¾¹æ æ¨¡å—å›½é™…åŒ– (50æ¡)"

# âŒ ä¸å¥½çš„æäº¤
git commit -m "feat(i18n): å®Œæˆå…¨éƒ¨å›½é™…åŒ– (4579æ¡)"
# å¤ªå¤§äº†ï¼Œéš¾ä»¥ review
```

---

## ğŸ†˜ å¸¸è§é—®é¢˜

### Q1: è‡ªåŠ¨æ›¿æ¢åä»£ç æŠ¥é”™ï¼Ÿ

**A**: æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š

1. import è¯­å¥æ˜¯å¦æ­£ç¡®
2. ç¿»è¯‘é”®æ˜¯å¦å­˜åœ¨äºè¯­è¨€åŒ…ä¸­
3. æ˜¯å¦è¯¯ä¼¤äº†éæ–‡æ¡ˆçš„å­—ç¬¦ä¸²

### Q2: ç¿»è¯‘é”®å¤ªé•¿ï¼Ÿ

**A**: æ‰‹åŠ¨ä¼˜åŒ–ï¼š

```json
// âŒ å¤ªé•¿
"messaging.æ— æ³•åˆ›å»ºä¹¦ç­¾ä¸ºç©ºæˆ–æœªå®šä¹‰": { "message": "..." }

// âœ… ç®€æ´
"error.bookmark.empty": { "message": "æ— æ³•åˆ›å»ºä¹¦ç­¾ï¼šä¸ºç©ºæˆ–æœªå®šä¹‰" }
```

### Q3: å¦‚ä½•å¤„ç†åŠ¨æ€æ–‡æœ¬ï¼Ÿ

**A**: ä½¿ç”¨å ä½ç¬¦ï¼š

```typescript
// ç¿»è¯‘é”®
{
  "bookmark.count": {
    "message": "å…± $1 ä¸ªä¹¦ç­¾",
    "description": "$1 æ˜¯ä¹¦ç­¾æ•°é‡"
  }
}

// ä½¿ç”¨
t('bookmark.count', String(count))
```

### Q4: å¦‚ä½•å¤„ç†å¤æ•°å½¢å¼ï¼Ÿ

**A**: æ‰‹åŠ¨åˆ¤æ–­ï¼š

```typescript
function getBookmarkCountText(count: number): string {
  if (count === 0) return t('bookmark.count.zero')
  if (count === 1) return t('bookmark.count.one')
  return t('bookmark.count.other', String(count))
}
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [å›½é™…åŒ–å®æ–½æŒ‡å—](./i18n-implementation-guide.md)
- [Chrome i18n API](https://developer.chrome.com/docs/extensions/reference/i18n/)
- [é¡¹ç›®è§„èŒƒ](../../.kiro/steering/project.md)

---

**æœ€åæ›´æ–°**: 2025-01-02
**ç»´æŠ¤è€…**: AcuityBookmarks Team
