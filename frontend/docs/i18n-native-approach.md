# AcuityBookmarks å›½é™…åŒ–æ–¹æ¡ˆè¯´æ˜

## ğŸ“‹ æ¦‚è¿°

AcuityBookmarks é‡‡ç”¨ **Chrome Extensions åŸç”Ÿ i18n æœºåˆ¶**ï¼Œå®Œå…¨éµå¾ª Chrome å®˜æ–¹æ ‡å‡†ï¼Œä¸ä½¿ç”¨ç¬¬ä¸‰æ–¹å›½é™…åŒ–åº“ã€‚

## ğŸ¯ è®¾è®¡åŸåˆ™

### 1. å®Œå…¨ä½¿ç”¨ Chrome åŸç”Ÿ API

æˆ‘ä»¬ä¸¥æ ¼éµå¾ª [Chrome Extensions i18n å®˜æ–¹æ–‡æ¡£](https://developer.chrome.com/docs/extensions/reference/api/i18n)ï¼Œä½¿ç”¨åŸç”Ÿèƒ½åŠ›ï¼š

- âœ… ä½¿ç”¨ `chrome.i18n.getMessage()` è·å–ç¿»è¯‘æ–‡æœ¬
- âœ… ä½¿ç”¨ `chrome.i18n.getUILanguage()` è·å–å½“å‰è¯­è¨€
- âœ… ä½¿ç”¨ `_locales` ç›®å½•ç»“æ„å­˜å‚¨ç¿»è¯‘æ–‡ä»¶
- âœ… ä½¿ç”¨ `default_locale` åœ¨ manifest.json ä¸­æŒ‡å®šé»˜è®¤è¯­è¨€

### 2. è¯­è¨€ç”±æµè§ˆå™¨å†³å®š

æ ¹æ® Chrome åŸç”Ÿæœºåˆ¶ï¼š

```
æµè§ˆå™¨ UI è¯­è¨€
    â†“
chrome.i18n.getUILanguage()
    â†“
è‡ªåŠ¨åŠ è½½å¯¹åº”çš„ _locales æ–‡ä»¶å¤¹
    â†“
æ‰©å±•æ˜¾ç¤ºå¯¹åº”è¯­è¨€
```

**é‡è¦**ï¼šæ‰©å±•çš„è¯­è¨€**å®Œå…¨ç”±æµè§ˆå™¨çš„ UI è¯­è¨€å†³å®š**ï¼Œæ— æ³•åœ¨æ‰©å±•å†…ç‹¬ç«‹åˆ‡æ¢ã€‚

## ğŸ—ï¸ æŠ€æœ¯å®ç°

### ç›®å½•ç»“æ„

```
frontend/
â”œâ”€â”€ _locales/
â”‚   â”œâ”€â”€ zh_CN/
â”‚   â”‚   â””â”€â”€ messages.json
â”‚   â”œâ”€â”€ zh_TW/
â”‚   â”‚   â””â”€â”€ messages.json
â”‚   â”œâ”€â”€ en/
â”‚   â”‚   â””â”€â”€ messages.json
â”‚   â”œâ”€â”€ ja/
â”‚   â”‚   â””â”€â”€ messages.json
â”‚   â”œâ”€â”€ ko/
â”‚   â”‚   â””â”€â”€ messages.json
â”‚   â”œâ”€â”€ de/
â”‚   â”‚   â””â”€â”€ messages.json
â”‚   â””â”€â”€ es/
â”‚       â””â”€â”€ messages.json
â””â”€â”€ src/
    â”œâ”€â”€ infrastructure/
    â”‚   â””â”€â”€ i18n/
    â”‚       â””â”€â”€ i18n-service.ts  # Chrome i18n API å°è£…
    â””â”€â”€ utils/
        â””â”€â”€ i18n-helpers.ts      # Vue Composable
```

### i18n æœåŠ¡

`i18n-service.ts` æ˜¯å¯¹ Chrome i18n API çš„è½»é‡å°è£…ï¼š

```typescript
// è·å–ç¿»è¯‘æ–‡æœ¬
t(key: string, substitutions?: string | string[]): string {
  return chrome.i18n.getMessage(key, substitutions)
}

// è·å–å½“å‰è¯­è¨€
getCurrentLanguage(): string {
  return chrome.i18n.getUILanguage()
}
```

### Vue é›†æˆ

é€šè¿‡ `useI18n()` Composable åœ¨ Vue ç»„ä»¶ä¸­ä½¿ç”¨ï¼š

```vue
<script setup lang="ts">
import { useI18n } from '@/utils/i18n-helpers'

const { t } = useI18n()
</script>

<template>
  <div>{{ t('welcome') }}</div>
</template>
```

## ğŸŒ æ”¯æŒçš„è¯­è¨€

| è¯­è¨€ä»£ç  | è¯­è¨€åç§° | æ–‡ä»¶å¤¹ |
|---------|---------|--------|
| zh-CN | ç®€ä½“ä¸­æ–‡ | `_locales/zh_CN/` |
| zh-TW | ç¹ä½“ä¸­æ–‡ | `_locales/zh_TW/` |
| en | è‹±è¯­ | `_locales/en/` |
| ja | æ—¥è¯­ | `_locales/ja/` |
| ko | éŸ©è¯­ | `_locales/ko/` |
| de | å¾·è¯­ | `_locales/de/` |
| es | è¥¿ç­ç‰™è¯­ | `_locales/es/` |

**æ³¨æ„**ï¼šæ–‡ä»¶å¤¹åä½¿ç”¨ä¸‹åˆ’çº¿ï¼ˆå¦‚ `zh_CN`ï¼‰ï¼Œä½† `chrome.i18n.getUILanguage()` è¿”å›è¿å­—ç¬¦æ ¼å¼ï¼ˆå¦‚ `zh-CN`ï¼‰ã€‚Chrome ä¼šè‡ªåŠ¨å¤„ç†è¿™ç§å·®å¼‚ã€‚

## ğŸ”„ è¯­è¨€åˆ‡æ¢æœºåˆ¶

### ç”¨æˆ·å¦‚ä½•åˆ‡æ¢è¯­è¨€ï¼Ÿ

1. æ‰“å¼€ Chrome è®¾ç½®ï¼š`chrome://settings/languages`
2. æ›´æ”¹"Chrome çš„è¯­è¨€"è®¾ç½®
3. é‡å¯æµè§ˆå™¨
4. æ‰©å±•è‡ªåŠ¨ä½¿ç”¨æ–°è¯­è¨€

### ä¸ºä»€ä¹ˆä¸æä¾›æ‰©å±•å†…çš„è¯­è¨€åˆ‡æ¢å™¨ï¼Ÿ

æ ¹æ® Chrome å®˜æ–¹æ–‡æ¡£å’Œæœ€ä½³å®è·µï¼š

**Chrome åŸç”Ÿ i18n çš„é™åˆ¶**ï¼š
- è¯­è¨€æ˜¯åœ¨æ‰©å±•åŠ è½½æ—¶ç¡®å®šçš„
- ç”± `chrome.i18n.getUILanguage()` è¿”å›çš„æµè§ˆå™¨ UI è¯­è¨€å†³å®š
- **æ²¡æœ‰å®˜æ–¹ API å¯ä»¥è®©æ‰©å±•æ‰‹åŠ¨åˆ‡æ¢è¯­è¨€**

**å¦‚æœå¼ºè¡Œå®ç°è¯­è¨€åˆ‡æ¢å™¨**ï¼š
- âŒ éœ€è¦ä½¿ç”¨ `chrome.storage` ä¿å­˜ç”¨æˆ·åå¥½
- âŒ éœ€è¦è°ƒç”¨ `chrome.runtime.reload()` é‡æ–°åŠ è½½æ‰©å±•
- âŒ ä½† Chrome ä»ç„¶ä¼šæ ¹æ®æµè§ˆå™¨ UI è¯­è¨€åŠ è½½ `_locales`
- âŒ æ— æ³•çœŸæ­£æ”¹å˜æ‰©å±•çš„è¯­è¨€ï¼Œé™¤éä¿®æ”¹æµè§ˆå™¨è¯­è¨€

**é‡‡ç”¨åŸç”Ÿæ–¹æ¡ˆçš„ä¼˜åŠ¿**ï¼š
- âœ… å®Œå…¨ç¬¦åˆ Chrome æ ‡å‡†
- âœ… ä»£ç æ›´ç®€å•ï¼Œæ— éœ€ç»´æŠ¤é¢å¤–é€»è¾‘
- âœ… ä¸æµè§ˆå™¨è¯­è¨€ä¿æŒä¸€è‡´
- âœ… é¿å…"æ‰©å±•è¯­è¨€"å’Œ"æµè§ˆå™¨è¯­è¨€"ä¸ä¸€è‡´çš„æ··ä¹±

## ğŸ“ ç¿»è¯‘æ–‡ä»¶æ ¼å¼

### messages.json ç»“æ„

```json
{
  "app_name": {
    "message": "AcuityBookmarks",
    "description": "åº”ç”¨åç§°"
  },
  "welcome": {
    "message": "æ¬¢è¿ä½¿ç”¨ $APP_NAME$",
    "description": "æ¬¢è¿æ¶ˆæ¯",
    "placeholders": {
      "app_name": {
        "content": "$1",
        "example": "AcuityBookmarks"
      }
    }
  }
}
```

### å ä½ç¬¦ä½¿ç”¨

```typescript
// ç®€å•å ä½ç¬¦
t('welcome', 'AcuityBookmarks')
// è¾“å‡ºï¼šæ¬¢è¿ä½¿ç”¨ AcuityBookmarks

// å¤šä¸ªå ä½ç¬¦
t('greeting', ['å¼ ä¸‰', 'ä¸Šåˆ'])
// è¾“å‡ºï¼šå¼ ä¸‰ï¼Œä¸Šåˆå¥½
```

## ğŸ§ª éªŒè¯å’Œæµ‹è¯•

### éªŒè¯ç¿»è¯‘å®Œæ•´æ€§

```bash
# éªŒè¯æ‰€æœ‰è¯­è¨€çš„ç¿»è¯‘æ–‡ä»¶
bun run i18n:validate

# è¾“å‡ºç¤ºä¾‹ï¼š
# âœ… æ‰€æœ‰ç¿»è¯‘éªŒè¯é€šè¿‡ï¼
# æ€»é”®æ•°: 542
# è¯­è¨€æ•°: 7
# ç¼ºå¤±ç¿»è¯‘: 0
```

### æµ‹è¯•ä¸åŒè¯­è¨€

1. æ›´æ”¹æµè§ˆå™¨è¯­è¨€ï¼š`chrome://settings/languages`
2. é‡å¯æµè§ˆå™¨
3. é‡æ–°åŠ è½½æ‰©å±•ï¼š`chrome://extensions/`
4. éªŒè¯æ‰©å±•ç•Œé¢æ˜¾ç¤ºä¸ºæ–°è¯­è¨€

## ğŸš« ä¸ä½¿ç”¨çš„æ–¹æ¡ˆ

### ä¸ºä»€ä¹ˆä¸ä½¿ç”¨ vue-i18nï¼Ÿ

- âŒ å¢åŠ åŒ…ä½“ç§¯ï¼ˆ~50KBï¼‰
- âŒ éœ€è¦ç»´æŠ¤ä¸¤å¥—ç¿»è¯‘ç³»ç»Ÿ
- âŒ ä¸ Chrome åŸç”Ÿæœºåˆ¶å†²çª
- âŒ æ— æ³•åˆ©ç”¨ Chrome çš„è‡ªåŠ¨è¯­è¨€é€‰æ‹©

### ä¸ºä»€ä¹ˆä¸ä½¿ç”¨ i18nextï¼Ÿ

- âŒ å¢åŠ åŒ…ä½“ç§¯å’Œå¤æ‚åº¦
- âŒ éœ€è¦æ‰‹åŠ¨ç®¡ç†è¯­è¨€åˆ‡æ¢
- âŒ ä¸ç¬¦åˆ Chrome Extensions æœ€ä½³å®è·µ

### ä¸ºä»€ä¹ˆä¸æä¾›è¯­è¨€é€‰æ‹©å™¨ï¼Ÿ

- âŒ Chrome åŸç”Ÿ i18n ä¸æ”¯æŒè¿è¡Œæ—¶åˆ‡æ¢è¯­è¨€
- âŒ å³ä½¿ä¿å­˜ç”¨æˆ·åå¥½ï¼ŒChrome ä»ä½¿ç”¨æµè§ˆå™¨ UI è¯­è¨€
- âŒ ä¼šå¯¼è‡´ç”¨æˆ·å›°æƒ‘ï¼ˆæ‰©å±•è¯­è¨€ä¸æµè§ˆå™¨è¯­è¨€ä¸ä¸€è‡´ï¼‰
- âŒ è¿å Chrome Extensions è®¾è®¡åŸåˆ™

## ğŸ“š ç›¸å…³èµ„æº

### å®˜æ–¹æ–‡æ¡£

- [Chrome Extensions i18n API](https://developer.chrome.com/docs/extensions/reference/api/i18n)
- [Chrome Extensions å›½é™…åŒ–æŒ‡å—](https://developer.chrome.com/docs/extensions/develop/concepts/i18n)
- [Manifest V3 å›½é™…åŒ–](https://developer.chrome.com/docs/extensions/mv3/i18n/)

### é¡¹ç›®æ–‡ä»¶

- `frontend/src/infrastructure/i18n/i18n-service.ts` - i18n æœåŠ¡
- `frontend/src/utils/i18n-helpers.ts` - Vue Composable
- `frontend/_locales/*/messages.json` - ç¿»è¯‘æ–‡ä»¶
- `frontend/scripts/i18n-validate.ts` - éªŒè¯è„šæœ¬

## ğŸ“ æœ€ä½³å®è·µ

### 1. ç¿»è¯‘é”®å‘½å

```typescript
// âœ… æ¨èï¼šä½¿ç”¨ç‚¹å·åˆ†éš”çš„å±‚çº§ç»“æ„
t('settings.general.title')
t('bookmark.action.delete')

// âŒ ä¸æ¨èï¼šä½¿ç”¨ä¸‹åˆ’çº¿
t('settings_general_title')
```

### 2. å ä½ç¬¦ä½¿ç”¨

```typescript
// âœ… æ¨èï¼šä½¿ç”¨æè¿°æ€§å ä½ç¬¦åç§°
{
  "message": "æ¬¢è¿ $USER_NAME$ï¼Œä»Šå¤©æ˜¯ $DATE$",
  "placeholders": {
    "user_name": { "content": "$1" },
    "date": { "content": "$2" }
  }
}

// âŒ ä¸æ¨èï¼šä½¿ç”¨æ•°å­—å ä½ç¬¦
{
  "message": "æ¬¢è¿ $1ï¼Œä»Šå¤©æ˜¯ $2"
}
```

### 3. æè¿°å­—æ®µ

```json
{
  "welcome": {
    "message": "æ¬¢è¿",
    "description": "é¦–é¡µæ¬¢è¿æ¶ˆæ¯"  // âœ… æ·»åŠ æè¿°ï¼Œå¸®åŠ©ç¿»è¯‘è€…ç†è§£ä¸Šä¸‹æ–‡
  }
}
```

### 4. åªç¿»è¯‘ç”¨æˆ·å¯è§çš„æ–‡æ¡ˆ

```typescript
// âœ… ç¿»è¯‘ç”¨æˆ·å¯è§çš„ UI æ–‡æ¡ˆ
const title = t('settings.title')

// âŒ ä¸ç¿»è¯‘æ—¥å¿—å’Œè°ƒè¯•ä¿¡æ¯
logger.info('ç”¨æˆ·ç‚¹å‡»äº†è®¾ç½®æŒ‰é’®')  // ä¿æŒä¸­æ–‡
```

## ğŸ”§ æ·»åŠ æ–°è¯­è¨€

### æ­¥éª¤

1. åœ¨ `_locales/` ä¸‹åˆ›å»ºæ–°è¯­è¨€æ–‡ä»¶å¤¹ï¼ˆå¦‚ `fr/`ï¼‰
2. å¤åˆ¶ `zh_CN/messages.json` ä½œä¸ºæ¨¡æ¿
3. ç¿»è¯‘æ‰€æœ‰æ–‡æ¡ˆ
4. è¿è¡ŒéªŒè¯ï¼š`bun run i18n:validate`
5. æµ‹è¯•æ–°è¯­è¨€

### ç¤ºä¾‹ï¼šæ·»åŠ æ³•è¯­

```bash
# 1. åˆ›å»ºæ–‡ä»¶å¤¹
mkdir frontend/_locales/fr

# 2. å¤åˆ¶æ¨¡æ¿
cp frontend/_locales/zh_CN/messages.json frontend/_locales/fr/

# 3. ç¿»è¯‘æ–‡æ¡ˆï¼ˆæ‰‹åŠ¨ç¼–è¾‘ fr/messages.jsonï¼‰

# 4. éªŒè¯
bun run i18n:validate

# 5. æµ‹è¯•
# - å°†æµè§ˆå™¨è¯­è¨€æ”¹ä¸ºæ³•è¯­
# - é‡å¯æµè§ˆå™¨
# - éªŒè¯æ‰©å±•æ˜¾ç¤ºä¸ºæ³•è¯­
```

## â“ å¸¸è§é—®é¢˜

### Q: ç”¨æˆ·å¦‚ä½•åˆ‡æ¢æ‰©å±•çš„è¯­è¨€ï¼Ÿ

A: æ‰©å±•çš„è¯­è¨€ç”±æµè§ˆå™¨çš„ UI è¯­è¨€å†³å®šã€‚ç”¨æˆ·éœ€è¦ï¼š
1. æ‰“å¼€ `chrome://settings/languages`
2. æ›´æ”¹"Chrome çš„è¯­è¨€"
3. é‡å¯æµè§ˆå™¨

### Q: ä¸ºä»€ä¹ˆä¸èƒ½åœ¨æ‰©å±•å†…åˆ‡æ¢è¯­è¨€ï¼Ÿ

A: Chrome Extensions i18n çš„è®¾è®¡å°±æ˜¯è¿™æ ·çš„ã€‚è¯­è¨€æ˜¯åœ¨æ‰©å±•åŠ è½½æ—¶ç”±æµè§ˆå™¨å†³å®šçš„ï¼Œæ²¡æœ‰å®˜æ–¹ API å¯ä»¥åœ¨è¿è¡Œæ—¶åˆ‡æ¢ã€‚

### Q: å¦‚æœæµè§ˆå™¨è¯­è¨€ä¸åœ¨æ”¯æŒåˆ—è¡¨ä¸­ä¼šæ€æ ·ï¼Ÿ

A: Chrome ä¼šä½¿ç”¨ `manifest.json` ä¸­æŒ‡å®šçš„ `default_locale`ï¼ˆé€šå¸¸æ˜¯ `en`ï¼‰ã€‚

### Q: å¯ä»¥è®©æ‰©å±•è¯­è¨€ä¸æµè§ˆå™¨è¯­è¨€ä¸åŒå—ï¼Ÿ

A: ä¸å¯ä»¥ã€‚è¿™è¿åäº† Chrome Extensions çš„è®¾è®¡åŸåˆ™ï¼Œä¹Ÿä¼šå¯¼è‡´ç”¨æˆ·ä½“éªŒæ··ä¹±ã€‚

### Q: ç¿»è¯‘æ–‡ä»¶å¯ä»¥ä½¿ç”¨ JSON5 æˆ– YAML å—ï¼Ÿ

A: ä¸å¯ä»¥ã€‚Chrome åªæ”¯æŒæ ‡å‡† JSON æ ¼å¼çš„ `messages.json` æ–‡ä»¶ã€‚

## ğŸ“Š ç»Ÿè®¡ä¿¡æ¯

- **æ”¯æŒè¯­è¨€æ•°**: 7
- **ç¿»è¯‘é”®æ€»æ•°**: 542
- **ç¿»è¯‘å®Œæ•´æ€§**: 100%
- **ä»£ç å¤§å°**: ~5KB (i18n æœåŠ¡ + helpers)

## âœ… éªŒè¯æ¸…å•

- [x] ä½¿ç”¨ Chrome åŸç”Ÿ i18n API
- [x] ç¿»è¯‘æ–‡ä»¶å­˜å‚¨åœ¨ `_locales` ç›®å½•
- [x] æ”¯æŒ 7 ç§è¯­è¨€
- [x] æ‰€æœ‰ç¿»è¯‘é”®éƒ½æœ‰å¯¹åº”çš„ç¿»è¯‘
- [x] ä¸ä½¿ç”¨ç¬¬ä¸‰æ–¹å›½é™…åŒ–åº“
- [x] ä¸æä¾›æ‰©å±•å†…çš„è¯­è¨€åˆ‡æ¢å™¨
- [x] å®Œå…¨éµå¾ª Chrome Extensions æ ‡å‡†

---

**æœ€åæ›´æ–°**: 2025-01-03  
**ç‰ˆæœ¬**: 2.0.0  
**çŠ¶æ€**: âœ… ç¬¦åˆ Chrome åŸç”Ÿæ ‡å‡†

