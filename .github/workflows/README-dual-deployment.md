# ğŸš€ åŒç«¯éƒ¨ç½²CI/CDé…ç½®è¯´æ˜

## ğŸ¯ **é¡¹ç›®æ¶æ„ç†è§£**

### **å‰ç«¯ (Chrome Extension)**:
- **æŠ€æœ¯æ ˆ**: Vue 3 + TypeScript + IndexedDB + Vite
- **æ„å»ºäº§ç‰©**: Chromeæ’ä»¶å‹ç¼©åŒ… (.zip)
- **éƒ¨ç½²ç›®æ ‡**: Google Chrome Web Store
- **åŠŸèƒ½**: ç”¨æˆ·ç•Œé¢ã€ä¹¦ç­¾ç®¡ç†ã€æœ¬åœ°æ•°æ®å­˜å‚¨

### **åç«¯ (Serverless Functions)**:
- **æŠ€æœ¯æ ˆ**: Bun (æœ¬åœ°å¼€å‘) â†’ Node.js (Verceléƒ¨ç½²)
- **éƒ¨ç½²ç›®æ ‡**: Vercel Serverless Functions
- **åŠŸèƒ½**: AI LLMè°ƒç”¨ã€ç½‘ç»œæŠ“åŒ…å¤„ç†ã€æ•°æ®åˆ†æ
- **APIç«¯ç‚¹**: `/api/ai/*`, `/api/scraper/*`, `/api/job/*`

---

## ğŸ”„ **CI/CDå·¥ä½œæµç¨‹**

### **dual-deployment-ci.yml** å·¥ä½œæµç¨‹:

```mermaid
graph TD
    A[ä»£ç æ¨é€] --> B[è´¨é‡æ£€æŸ¥]
    B --> C[å‰ç«¯æ„å»ºéªŒè¯]
    B --> D[åç«¯æ„å»ºéªŒè¯]
    C --> E[Chromeæ‰©å±•éƒ¨ç½²]
    D --> F[Serverlessåç«¯éƒ¨ç½²]
    E --> G[éƒ¨ç½²çŠ¶æ€é€šçŸ¥]
    F --> G
```

### **1. ğŸ” è´¨é‡æ£€æŸ¥é˜¶æ®µ**
- **å®‰å…¨å®¡è®¡**: `bun audit` (å‰åç«¯)
- **TypeScriptæ£€æŸ¥**: å‰ç«¯ç±»å‹éªŒè¯
- **ä»£ç è´¨é‡**: ESLintæ£€æŸ¥ (å‰åç«¯)

### **2. ğŸ”¨ æ„å»ºéªŒè¯é˜¶æ®µ**

#### **Chromeæ‰©å±•æ„å»º**:
- Vue 3é¡¹ç›®æ„å»º (`bun run build:prod`)
- æ‰©å±•å¤§å°åˆ†æ (é™åˆ¶20MB)
- Manifest.jsonéªŒè¯
- æ–‡ä»¶ç»“æ„æ£€æŸ¥
- åˆ›å»ºæ‰©å±•åŒ… (.zip)

#### **Serverlessåç«¯æ„å»º**:
- Buné¡¹ç›®è¯­æ³•æ£€æŸ¥
- æœåŠ¡å™¨åŠŸèƒ½æµ‹è¯•
- æ€§èƒ½åŸºå‡†æµ‹è¯•
- Vercelå…¼å®¹æ€§æ£€æŸ¥

### **3. ğŸš€ éƒ¨ç½²é˜¶æ®µ**

#### **Chromeæ‰©å±•éƒ¨ç½²**:
- æ„å»ºç”Ÿäº§ç‰ˆæœ¬
- åˆ›å»ºå‘å¸ƒåŒ…
- éƒ¨ç½²åˆ°Chrome Web Store (éœ€è¦APIå¯†é’¥)
- åˆ›å»ºGitHub Release

#### **Serverlessåç«¯éƒ¨ç½²**:
- å‡†å¤‡Vercelé…ç½®
- éƒ¨ç½²åˆ°Vercel Serverless
- åˆ›å»ºåç«¯ç‰ˆæœ¬Release

---

## âš™ï¸ **å¿…éœ€çš„Secretsé…ç½®**

### **Chrome Web Storeéƒ¨ç½²**:
```
CHROME_CLIENT_ID=your_chrome_client_id
CHROME_CLIENT_SECRET=your_chrome_client_secret
CHROME_REFRESH_TOKEN=your_chrome_refresh_token
CHROME_EXTENSION_ID=your_extension_id
```

### **Verceléƒ¨ç½²**:
```
VERCEL_TOKEN=your_vercel_token
ORG_ID=your_vercel_org_id
PROJECT_ID=your_vercel_project_id
```

---

## ğŸ“ **æ–°å¢çš„é…ç½®æ–‡ä»¶**

### **backend/vercel.json**
```json
{
  "version": 2,
  "builds": [
    {
      "src": "server-bun-native.js",
      "use": "@vercel/node"
    }
  ],
  "routes": [
    {
      "src": "/(.*)",
      "dest": "/server-bun-native.js"
    }
  ]
}
```

### **backend/api/index.js**
Vercel Serverless Functionsé€‚é…å±‚ï¼Œæä¾›:
- **AIæœåŠ¡**: `/api/ai/analyze`, `/api/ai/query`
- **æŠ“åŒ…æœåŠ¡**: `/api/scraper/fetch`
- **ä»»åŠ¡çŠ¶æ€**: `/api/job/{jobId}`
- **å¥åº·æ£€æŸ¥**: `/health`

---

## ğŸ”§ **å¼€å‘ç¯å¢ƒvsç”Ÿäº§ç¯å¢ƒ**

### **å¼€å‘ç¯å¢ƒ**:
- **å‰ç«¯**: `bun run dev` (Viteå¼€å‘æœåŠ¡å™¨)
- **åç«¯**: `bun run dev` (BunåŸç”ŸæœåŠ¡å™¨)
- **é›†æˆ**: é€šè¿‡æœ¬åœ°APIè°ƒç”¨æµ‹è¯•

### **ç”Ÿäº§ç¯å¢ƒ**:
- **å‰ç«¯**: Chrome Web Storeåˆ†å‘
- **åç«¯**: Vercel Serverless Functions
- **é›†æˆ**: Chromeæ‰©å±• â†” Vercel API

---

## ğŸ“Š **éƒ¨ç½²ç›‘æ§**

### **æˆåŠŸæŒ‡æ ‡**:
- âœ… å‰ç«¯æ„å»ºæ— é”™è¯¯
- âœ… Chromeæ‰©å±•åŒ… < 20MB
- âœ… Manifest.jsoné€šè¿‡éªŒè¯
- âœ… åç«¯APIå“åº”æ­£å¸¸
- âœ… Verceléƒ¨ç½²æˆåŠŸ

### **éƒ¨ç½²çŠ¶æ€**:
- **å®Œå…¨æˆåŠŸ**: å‰ç«¯ + åç«¯éƒ½éƒ¨ç½²æˆåŠŸ
- **éƒ¨åˆ†æˆåŠŸ**: å•ç«¯éƒ¨ç½²æˆåŠŸï¼Œå¦ä¸€ç«¯å¤±è´¥
- **å®Œå…¨å¤±è´¥**: å‰åç«¯éƒ½éƒ¨ç½²å¤±è´¥

---

## ğŸš¨ **æ•…éšœæ’é™¤**

### **å¸¸è§é—®é¢˜**:

#### **1. Chromeæ‰©å±•æ„å»ºå¤±è´¥**
```bash
# æ£€æŸ¥æ„å»ºè„šæœ¬
cd frontend
bun run build:prod

# æ£€æŸ¥æ–‡ä»¶å¤§å°
du -sh ../dist

# éªŒè¯manifest
jq . ../dist/manifest.json
```

#### **2. Verceléƒ¨ç½²å¤±è´¥**
```bash
# æœ¬åœ°æµ‹è¯•åç«¯
cd backend
bun run start

# æ£€æŸ¥APIç«¯ç‚¹
curl http://localhost:3000/health
curl http://localhost:3000/api
```

#### **3. APIé›†æˆé—®é¢˜**
- æ£€æŸ¥CORSé…ç½®
- éªŒè¯APIç«¯ç‚¹URL
- ç¡®è®¤ç¯å¢ƒå˜é‡è®¾ç½®

---

## ğŸ¯ **æœ€ä½³å®è·µ**

### **ä»£ç è´¨é‡**:
- æ¯æ¬¡æäº¤å‰è¿è¡Œ `bun run lint:check`
- ä½¿ç”¨ `bun run type-check` éªŒè¯TypeScript
- å®šæœŸè¿è¡Œå®‰å…¨å®¡è®¡ `bun audit`

### **éƒ¨ç½²ç­–ç•¥**:
- ä½¿ç”¨feature brancheså¼€å‘
- mainåˆ†æ”¯è§¦å‘ç”Ÿäº§éƒ¨ç½²
- é€šè¿‡GitHub Releasesç®¡ç†ç‰ˆæœ¬

### **ç›‘æ§ä¸ç»´æŠ¤**:
- å…³æ³¨CI/CDæ„å»ºçŠ¶æ€
- ç›‘æ§Chrome Web Storeå®¡æ ¸çŠ¶æ€
- æ£€æŸ¥Vercel Serverless Functionsæ€§èƒ½æŒ‡æ ‡

---

## ğŸ“ˆ **æœªæ¥æ”¹è¿›**

### **å¯è€ƒè™‘çš„å¢å¼ºåŠŸèƒ½**:
- **æµ‹è¯•è¦†ç›–**: æ·»åŠ å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
- **æ€§èƒ½ç›‘æ§**: æ·»åŠ æ„å»ºæ—¶é—´å’ŒåŒ…å¤§å°è¶‹åŠ¿åˆ†æ
- **è‡ªåŠ¨å›æ»š**: éƒ¨ç½²å¤±è´¥æ—¶çš„è‡ªåŠ¨å›æ»šæœºåˆ¶
- **å¤šç¯å¢ƒæ”¯æŒ**: æ·»åŠ stagingç¯å¢ƒ
- **æ›´å¥½çš„é”™è¯¯å¤„ç†**: æ›´è¯¦ç»†çš„å¤±è´¥é€šçŸ¥å’Œæ—¥å¿—

---

## ğŸ‰ **æ€»ç»“**

è¿™ä¸ªåŒç«¯éƒ¨ç½²CI/CDé…ç½®ä¸ºAcuityBookmarksé¡¹ç›®æä¾›äº†ï¼š

- âœ… **å®Œæ•´çš„è‡ªåŠ¨åŒ–æµç¨‹**: ä»ä»£ç æäº¤åˆ°ç”Ÿäº§éƒ¨ç½²
- âœ… **åŒç«¯åŒæ­¥éƒ¨ç½²**: Chromeæ‰©å±• + Serverlessåç«¯
- âœ… **è´¨é‡ä¿è¯**: ä»£ç æ£€æŸ¥ã€æ„å»ºéªŒè¯ã€å®‰å…¨å®¡è®¡
- âœ… **çµæ´»çš„é…ç½®**: é€‚åº”é¡¹ç›®ç‰¹å®šéœ€æ±‚
- âœ… **æ¸…æ™°çš„ç›‘æ§**: éƒ¨ç½²çŠ¶æ€å’Œé”™è¯¯æŠ¥å‘Š

ç¡®ä¿Chromeæ‰©å±•çš„ç”¨æˆ·ä½“éªŒä¸åç«¯APIæœåŠ¡çš„å®Œç¾é›†æˆï¼ğŸš€
