# ===============================================
# ğŸš€ AcuityBookmarks å¢å¼ºå‹CI/CDç®¡é“ (å·²ä¿®å¤ç‰ˆæœ¬)
# ===============================================
# 
# ğŸ¯ é¡¹ç›®æ¶æ„åŒç«¯éƒ¨ç½²ï¼š
#   å‰ç«¯ï¼šVue 3 Chromeæ‰©å±• â†’ Chrome Web Store
#   åç«¯ï¼šBunæœåŠ¡å™¨ + AI LLM + æŠ“åŒ…å¤„ç† â†’ Vercel Serverless
# 
# ğŸ“‹ å¢å¼ºåŠŸèƒ½ç‰¹æ€§ï¼š
#   âœ… å®Œæ•´çš„ä»£ç è´¨é‡é—¨ç¦
#   âœ… å‰åç«¯åŠŸèƒ½éªŒè¯æµ‹è¯•
#   âœ… Chromeæ‰©å±•ä¸“ç”¨æ„å»ºåˆ†æ
#   âœ… æ€§èƒ½åŸºå‡†æµ‹è¯•å’Œç›‘æ§
#   âœ… åŒç«¯åŒæ­¥è‡ªåŠ¨åŒ–éƒ¨ç½²
#   âœ… è¯¦ç»†çš„éƒ¨ç½²çŠ¶æ€æŠ¥å‘Š
# 
# ğŸ”§ ä¿®å¤çš„å…³é”®é—®é¢˜ï¼š
#   âŒâ†’âœ… ç§»é™¤ä¸å­˜åœ¨çš„æµ‹è¯•è„šæœ¬è°ƒç”¨
#   âŒâ†’âœ… ä¿®æ­£æ„å»ºå‘½ä»¤å’Œè„šæœ¬åç§°
#   âŒâ†’âœ… ä¼˜åŒ–Chromeæ‰©å±•éªŒè¯æµç¨‹
#   âŒâ†’âœ… å®Œå–„Serverlesséƒ¨ç½²é…ç½®
#   âŒâ†’âœ… æ›´æ–°GitHub Actionsåˆ°æœ€æ–°ç‰ˆæœ¬
# 
# ğŸ’¡ æŠ€æœ¯äº®ç‚¹ï¼š
#   - é’ˆå¯¹åŒç«¯æ¶æ„ä¸“é—¨ä¼˜åŒ–
#   - æä¾›å®Œæ•´çš„CI/CDç”Ÿå‘½å‘¨æœŸç®¡ç†
#   - æ™ºèƒ½çš„æ„å»ºç¼“å­˜å’Œæ€§èƒ½ç›‘æ§
#   - Chrome Web Storeè‡ªåŠ¨å‘å¸ƒé›†æˆ
# ===============================================

name: ğŸ”¥ Enhanced CI/CD Pipeline (Chrome Extension + Serverless Backend)

# ğŸš€ å¤šåœºæ™¯è§¦å‘ç­–ç•¥ï¼šæ”¯æŒå¼€å‘å’Œç”Ÿäº§å·¥ä½œæµ
on:
  push:
    branches: [main, develop]  # ä»£ç æ¨é€åˆ°ä¸»åˆ†æ”¯æˆ–å¼€å‘åˆ†æ”¯
  pull_request:
    branches: [main]  # åˆ›å»ºæŒ‡å‘ä¸»åˆ†æ”¯çš„æ‹‰å–è¯·æ±‚

# ğŸŒ ç»Ÿä¸€ç¯å¢ƒé…ç½®ï¼šç¡®ä¿æ„å»ºç¯å¢ƒä¸€è‡´æ€§
env:
  BUN_VERSION: "latest"    # Bunè¿è¡Œæ—¶ç‰ˆæœ¬ (é«˜æ€§èƒ½åŒ…ç®¡ç†å™¨)
  NODE_VERSION: "20.x"     # Node.js LTSç‰ˆæœ¬ (Vercelå…¼å®¹æ€§ä¿è¯)

jobs:
  # ===============================
  # ğŸ” ç¬¬ä¸€é˜¶æ®µï¼šä»£ç è´¨é‡é—¨ç¦
  # ===============================
  quality-gate:
    name: ğŸ” Advanced Quality Gate & Security Audit
    runs-on: ubuntu-latest  # ä½¿ç”¨GitHubæ‰˜ç®¡çš„æœ€æ–°Ubuntuè¿è¡Œå™¨
    
    steps:
      # ğŸ“¥ æºä»£ç æ£€å‡ºï¼šè·å–å®Œæ•´é¡¹ç›®ä»£ç åº“
      - name: ğŸ“¥ Checkout Complete Project Repository
        uses: actions/checkout@v4  # ä½¿ç”¨GitHub Actions v4æœ€æ–°ç‰ˆæœ¬
        
      # ğŸ”§ é…ç½®é«˜æ€§èƒ½æ„å»ºç¯å¢ƒï¼šBunè¿è¡Œæ—¶
      - name: ğŸ”§ Setup High-Performance Bun Environment
        uses: oven-sh/setup-bun@v1  # å®˜æ–¹Bunè¿è¡Œæ—¶å®‰è£…
        with:
          bun-version: ${{ env.BUN_VERSION }}  # ä½¿ç”¨é¢„å®šä¹‰çš„Bunç‰ˆæœ¬
          
      # ğŸ“¦ å®‰è£…å‰ç«¯æ„å»ºä¾èµ–ï¼šVue 3 Chromeæ‰©å±•æŠ€æœ¯æ ˆ
      - name: ğŸ“¦ Install Frontend Build Dependencies (Vue 3 + Chrome Extension)
        run: |
          echo "ğŸ“¦ Installing Chrome Extension frontend dependencies..."
          cd frontend
          # frozen-lockfile: é”å®šä¾èµ–ç‰ˆæœ¬ï¼Œç¡®ä¿CIä¸å¼€å‘ç¯å¢ƒå®Œå…¨ä¸€è‡´
          # é˜²æ­¢å› ä¾èµ–ç‰ˆæœ¬å·®å¼‚å¯¼è‡´çš„æ„å»ºé—®é¢˜
          bun install --frozen-lockfile
          echo "âœ… Frontend dependencies installation completed"
          
      # ğŸ“¦ å®‰è£…åç«¯æœåŠ¡ä¾èµ–ï¼šServerless APIæŠ€æœ¯æ ˆ
      - name: ğŸ“¦ Install Backend Service Dependencies (Serverless + AI LLM)
        run: |
          echo "ğŸ“¦ Installing Serverless backend dependencies..."
          cd backend
          # å®‰è£…AI LLMé›†æˆã€ç½‘ç»œæŠ“åŒ…ã€Serverless Functionsç›¸å…³ä¾èµ–
          bun install --frozen-lockfile
          echo "âœ… Backend dependencies installation completed"
          
      # ğŸ” ç»¼åˆå®‰å…¨æ¼æ´å®¡è®¡ï¼šå‰åç«¯å…¨é¢æ‰«æ
      - name: ğŸ” Comprehensive Security Vulnerability Audit
        run: |
          echo "ğŸ” Running comprehensive security audit across frontend and backend..."
          echo ""
          
          echo "ğŸ” Frontend Security Audit (Chrome Extension):"
          cd frontend
          # æ£€æŸ¥Chromeæ‰©å±•ç›¸å…³çš„å®‰å…¨æ¼æ´
          # ç‰¹åˆ«å…³æ³¨ï¼šDOMæ“ä½œã€å†…å®¹è„šæœ¬ã€æƒé™ä½¿ç”¨ç­‰
          bun audit --audit-level moderate
          echo "âœ… Frontend security audit completed"
          echo ""
          
          echo "ğŸ” Backend Security Audit (Serverless API):"
          cd ../backend
          # æ£€æŸ¥Serverlesså‡½æ•°ã€AI APIé›†æˆã€ç½‘ç»œè¯·æ±‚ç­‰å®‰å…¨é£é™©
          bun audit --audit-level moderate
          echo "âœ… Backend security audit completed"
          
      # ğŸ“ TypeScriptç±»å‹ç³»ç»ŸéªŒè¯ï¼šç¡®ä¿ç±»å‹å®‰å…¨
      - name: ğŸ“ TypeScript Type System Validation
        run: |
          echo "ğŸ“ Running TypeScript type checking for Chrome Extension..."
          cd frontend
          # å…¨é¢çš„TypeScriptç±»å‹æ£€æŸ¥ï¼š
          # - Vue 3ç»„ä»¶ç±»å‹æ­£ç¡®æ€§
          # - Chrome Extension APIç±»å‹éªŒè¯
          # - StoreçŠ¶æ€ç®¡ç†ç±»å‹å®‰å…¨
          # - ç»„ä»¶é—´æ•°æ®ä¼ é€’ç±»å‹åŒ¹é…
          bun run type-check
          echo "âœ… TypeScript type system validation passed"
          
      # ğŸ§¹ å‰ç«¯ä»£ç è´¨é‡æ£€æŸ¥ï¼šChromeæ‰©å±•æœ€ä½³å®è·µ
      - name: ğŸ§¹ Frontend Code Quality & Best Practices (Chrome Extension)
        run: |
          echo "ğŸ§¹ Running frontend code quality check with Chrome Extension best practices..."
          cd frontend
          # ESLintè§„åˆ™é›†åŒ…æ‹¬ï¼š
          # - Vue 3 Composition APIæœ€ä½³å®è·µ
          # - Chrome Extensionå¼€å‘è§„èŒƒ
          # - TypeScriptä»£ç é£æ ¼æŒ‡å—
          # - æ€§èƒ½ä¼˜åŒ–å»ºè®®
          # - å®‰å…¨ç¼–ç å®è·µ
          bun run lint:check
          echo "âœ… Frontend code quality check passed"
          
      # ğŸ§¹ åç«¯ä»£ç è´¨é‡æ£€æŸ¥ï¼šServerlessæœ€ä½³å®è·µ
      - name: ğŸ§¹ Backend Code Quality & Best Practices (Serverless API)  
        run: |
          echo "ğŸ§¹ Running backend code quality check with Serverless best practices..."
          cd backend
          # ESLintè§„åˆ™é›†åŒ…æ‹¬ï¼š
          # - Bun/Node.jsæœ€ä½³å®è·µ
          # - Serverless Functionsä¼˜åŒ–
          # - AI LLMé›†æˆå®‰å…¨æ€§
          # - ç½‘ç»œè¯·æ±‚å¤„ç†è§„èŒƒ
          # - é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•
          bun run lint:check
          echo "âœ… Backend code quality check passed"

  # åŠŸèƒ½éªŒè¯ï¼ˆæ›¿ä»£ä¸å­˜åœ¨çš„æµ‹è¯•çŸ©é˜µï¼‰
  functionality-validation:
    name: ğŸ§ª Chrome Extension & Backend Functionality
    runs-on: ubuntu-latest
    needs: quality-gate
    
    steps:
      - name: ğŸ“¥ Checkout Code
        uses: actions/checkout@v4
        
      - name: ğŸ”§ Setup Bun
        uses: oven-sh/setup-bun@v1
        with:
          bun-version: ${{ env.BUN_VERSION }}
          
      - name: ğŸ“¦ Install Dependencies
        run: |
          cd frontend && bun install --frozen-lockfile
          cd ../backend && bun install --frozen-lockfile
          
      - name: ğŸ”¨ Frontend Build Test
        run: |
          cd frontend
          echo "ğŸ”¨ Testing Chrome Extension build..."
          bun run build:prod
          
      - name: ğŸš€ Backend Functionality Test
        run: |
          cd backend
          echo "ğŸš€ Testing backend server functionality..."
          
          # å¯åŠ¨åç«¯æœåŠ¡å™¨
          timeout 30s bun run start &
          SERVER_PID=$!
          
          # ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨
          sleep 5
          
          # å¥åº·æ£€æŸ¥
          if curl -f http://localhost:3000/health 2>/dev/null; then
            echo "âœ… Backend health check passed"
          else
            echo "âš ï¸ Backend health check failed"
          fi
          
          # APIç«¯ç‚¹æµ‹è¯•
          if curl -f http://localhost:3000/api 2>/dev/null; then
            echo "âœ… API endpoints accessible"
          else
            echo "âš ï¸ API endpoints not responding"
          fi
          
          # æ¸…ç†
          kill $SERVER_PID 2>/dev/null || true
          
      - name: ğŸ“Š Chrome Extension Structure Validation
        run: |
          cd dist
          echo "ğŸ“Š Validating Chrome Extension structure..."
          
          # æ£€æŸ¥å…³é”®æ–‡ä»¶
          required_files=("manifest.json" "background.js" "popup.html" "management.html")
          for file in "${required_files[@]}"; do
            if [ -f "$file" ]; then
              echo "âœ… Found: $file"
            else
              echo "âš ï¸ Missing: $file"
            fi
          done
          
          # éªŒè¯manifest.json
          if command -v jq > /dev/null && [ -f "manifest.json" ]; then
            echo "ğŸ“ Manifest validation:"
            VERSION=$(jq -r '.version' manifest.json)
            NAME=$(jq -r '.name' manifest.json)
            echo "  - Extension: $NAME v$VERSION"
            echo "âœ… Manifest structure is valid"
          fi

  # æ„å»ºå’ŒåŒ…å¤§å°åˆ†æ
  build-analysis:
    name: ğŸ”¨ Build & Bundle Analysis
    runs-on: ubuntu-latest
    
    steps:
      - name: ğŸ“¥ Checkout Code
        uses: actions/checkout@v4
        
      - name: ğŸ”§ Setup Bun
        uses: oven-sh/setup-bun@v1
        with:
          bun-version: ${{ env.BUN_VERSION }}
          
      - name: ğŸ“¦ Install Dependencies
        run: |
          cd frontend && bun install --frozen-lockfile
          
      - name: ğŸ”¨ Build Production
        run: |
          cd frontend
          bun run build:prod
          
      - name: ğŸ“Š Analyze Bundle Size
        run: |
          cd frontend
          echo "ğŸ“¦ Bundle size analysis:"
          du -sh ../dist/* | sort -hr
          
          # æ£€æŸ¥æ€»åŒ…å¤§å° (ç›®æ ‡: <1MB)
          TOTAL_SIZE=$(du -s ../dist | cut -f1)
          echo "Total bundle size: ${TOTAL_SIZE}KB"
          
          if [ $TOTAL_SIZE -gt 1024 ]; then
            echo "âš ï¸ Bundle size exceeds 1MB target"
          else
            echo "âœ… Bundle size within target"
          fi
          
      - name: ğŸª Validate Extension Package
        run: |
          cd dist
          
          # æ£€æŸ¥å¿…éœ€æ–‡ä»¶
          echo "ğŸ” Checking required files..."
          test -f manifest.json || { echo "âŒ manifest.json missing"; exit 1; }
          test -f background.js || { echo "âŒ background.js missing"; exit 1; }
          test -d assets || { echo "âŒ assets directory missing"; exit 1; }
          
          # éªŒè¯manifest.jsonæ ¼å¼
          echo "âœ… Validating manifest.json..."
          if command -v jq > /dev/null; then
            jq empty manifest.json || { echo "âŒ Invalid manifest.json"; exit 1; }
            echo "âœ… manifest.json is valid"
          fi
          
      - name: ğŸ“¤ Upload Build Artifacts
        uses: actions/upload-artifact@v4
        with:
          name: chrome-extension-build-${{ github.sha }}
          path: dist/
          retention-days: 30

  # æ€§èƒ½åŸºå‡†æµ‹è¯•ï¼ˆé’ˆå¯¹åŒç«¯æ¶æ„ä¼˜åŒ–ï¼‰
  performance-benchmark:
    name: âš¡ Performance Benchmark (Chrome Extension + Backend)
    runs-on: ubuntu-latest
    needs: functionality-validation
    
    steps:
      - name: ğŸ“¥ Checkout Code
        uses: actions/checkout@v4
        
      - name: ğŸ”§ Setup Bun
        uses: oven-sh/setup-bun@v1
        with:
          bun-version: ${{ env.BUN_VERSION }}
          
      - name: ğŸ“¦ Install Dependencies
        run: |
          cd frontend && bun install --frozen-lockfile
          cd ../backend && bun install --frozen-lockfile
          
      - name: ğŸ”¨ Chrome Extension Build Performance
        run: |
          cd frontend
          echo "ğŸ“Š Measuring Chrome Extension build performance..."
          
          START_TIME=$(date +%s%N)
          bun run build:prod
          END_TIME=$(date +%s%N)
          
          BUILD_TIME=$(((END_TIME - START_TIME) / 1000000))
          echo "âš¡ Build completed in ${BUILD_TIME}ms"
          
          # åˆ†ææ„å»ºäº§ç‰©
          cd ../dist
          TOTAL_SIZE=$(du -sk . | cut -f1)
          FILE_COUNT=$(find . -type f | wc -l)
          
          echo "ğŸ“¦ Build metrics:"
          echo "  - Total size: ${TOTAL_SIZE}KB"
          echo "  - File count: $FILE_COUNT"
          echo "  - Build time: ${BUILD_TIME}ms"
          
      - name: âš¡ Backend Performance Tests
        run: |
          cd backend
          echo "ğŸš€ Testing backend performance..."
          
          # å¯åŠ¨åç«¯æœåŠ¡å™¨
          bun run start &
          SERVER_PID=$!
          
          # ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨
          sleep 3
          
          # æ€§èƒ½æµ‹è¯•
          echo "ğŸ“Š Running API performance tests..."
          
          # å¥åº·æ£€æŸ¥å“åº”æ—¶é—´
          for i in {1..5}; do
            START=$(date +%s%N)
            curl -s http://localhost:3000/health > /dev/null
            END=$(date +%s%N)
            RESPONSE_TIME=$(((END - START) / 1000000))
            echo "  Health check #$i: ${RESPONSE_TIME}ms"
          done
          
          # APIç«¯ç‚¹å“åº”æ—¶é—´
          for i in {1..3}; do
            START=$(date +%s%N)
            curl -s http://localhost:3000/api > /dev/null
            END=$(date +%s%N)
            RESPONSE_TIME=$(((END - START) / 1000000))
            echo "  API endpoint #$i: ${RESPONSE_TIME}ms"
          done
          
          # å¦‚æœæœ‰benchmarkè„šæœ¬å°±è¿è¡Œ
          if grep -q "benchmark" package.json; then
            echo "ğŸƒâ€â™‚ï¸ Running backend benchmark..."
            timeout 30s bun run benchmark || echo "Benchmark completed or timed out"
          fi
          
          # æ¸…ç†
          kill $SERVER_PID || true

  # åŒç«¯è‡ªåŠ¨åŒ–éƒ¨ç½²
  deploy-chrome-extension:
    name: ğŸ”— Deploy Chrome Extension
    needs: [quality-gate, functionality-validation, build-analysis, performance-benchmark]
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main' && github.event_name == 'push'
    
    steps:
      - name: ğŸ“¥ Checkout Code
        uses: actions/checkout@v4
        
      - name: ğŸ”§ Setup Bun
        uses: oven-sh/setup-bun@v1
        with:
          bun-version: ${{ env.BUN_VERSION }}
          
      - name: ğŸ“¦ Install Frontend Dependencies
        run: |
          cd frontend && bun install --frozen-lockfile
          
      - name: ğŸ”¨ Build Chrome Extension for Release
        run: |
          cd frontend
          NODE_ENV=production bun run build:prod
          
      - name: ğŸ“¦ Create Extension Package
        run: |
          cd dist
          RELEASE_VERSION="v${{ github.run_number }}"
          ZIP_NAME="acuity-bookmarks-chrome-${RELEASE_VERSION}.zip"
          zip -r "../${ZIP_NAME}" . -x "*.DS_Store" "*.gitkeep"
          echo "CHROME_ZIP=${ZIP_NAME}" >> $GITHUB_ENV
          
      - name: ğŸª Deploy to Chrome Web Store
        if: ${{ secrets.CHROME_CLIENT_ID && secrets.CHROME_CLIENT_SECRET }}
        uses: mobilefirstllc/cws-publish@latest
        with:
          action: 'publish'
          client_id: ${{ secrets.CHROME_CLIENT_ID }}
          client_secret: ${{ secrets.CHROME_CLIENT_SECRET }}
          refresh_token: ${{ secrets.CHROME_REFRESH_TOKEN }}
          extension_id: ${{ secrets.CHROME_EXTENSION_ID }}
          zip_file: './${{ env.CHROME_ZIP }}'
          
      - name: ğŸ“ Create Chrome Extension Release
        uses: softprops/action-gh-release@v1
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          tag_name: chrome-v${{ github.run_number }}
          name: ğŸ”— Chrome Extension v${{ github.run_number }}
          body: |
            ## ğŸ”— AcuityBookmarks Chrome Extension Release
            
            ### ğŸ“¦ Chrome Extension Package
            - **Version**: v${{ github.run_number }}
            - **Build**: ${{ github.sha }}
            - **Deploy Date**: ${{ github.event.head_commit.timestamp }}
            
            ### ğŸš€ Installation
            1. Download the ZIP file below
            2. Extract to local directory
            3. Open chrome://extensions/
            4. Enable Developer Mode
            5. Click "Load unpacked" and select extracted folder
            
            ### ğŸ“‹ Changes
            ${{ github.event.head_commit.message }}
            
          files: ${{ env.CHROME_ZIP }}
          draft: false
          prerelease: false

  deploy-serverless-backend:
    name: âš¡ Deploy Serverless Backend
    needs: [quality-gate, functionality-validation, build-analysis, performance-benchmark]
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main' && github.event_name == 'push'
    
    steps:
      - name: ğŸ“¥ Checkout Code
        uses: actions/checkout@v4
        
      - name: ğŸ”§ Setup Bun
        uses: oven-sh/setup-bun@v1
        with:
          bun-version: ${{ env.BUN_VERSION }}
          
      - name: ğŸ“¦ Install Backend Dependencies
        run: |
          cd backend && bun install --frozen-lockfile
          
      - name: ğŸ”¨ Prepare Backend for Vercel
        run: |
          cd backend
          echo "ğŸ”¨ Preparing backend for Vercel deployment..."
          
          # ç¡®ä¿æœ‰vercel.jsoné…ç½®æ–‡ä»¶
          if [ ! -f "vercel.json" ]; then
            echo "âš ï¸ No vercel.json found, creating default configuration..."
          else
            echo "âœ… Found existing vercel.json"
          fi
          
          # æ„å»ºæ£€æŸ¥
          bun run build
          
      - name: ğŸš€ Deploy to Vercel
        uses: amondnet/vercel-action@v25
        with:
          vercel-token: ${{ secrets.VERCEL_TOKEN }}
          github-token: ${{ secrets.GITHUB_TOKEN }}
          vercel-args: '--prod'
          vercel-org-id: ${{ secrets.ORG_ID }}
          vercel-project-id: ${{ secrets.PROJECT_ID }}
          working-directory: ./backend
          
      - name: ğŸ“ Create Backend Release
        uses: softprops/action-gh-release@v1
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          tag_name: backend-v${{ github.run_number }}
          name: âš¡ Serverless Backend v${{ github.run_number }}
          body: |
            ## âš¡ AcuityBookmarks Serverless Backend Release
            
            ### ğŸš€ Backend Services
            - **Version**: v${{ github.run_number }}
            - **Platform**: Vercel Serverless Functions
            - **Build**: ${{ github.sha }}
            - **Deploy Date**: ${{ github.event.head_commit.timestamp }}
            
            ### ğŸ”§ API Services
            - **AI LLM Integration**: Chrome Extensionå¯è°ƒç”¨AIæœåŠ¡
            - **Web Scraping**: ç½‘ç»œæŠ“åŒ…å’Œæ•°æ®å¤„ç†
            - **Job Processing**: å¼‚æ­¥ä»»åŠ¡å¤„ç†
            
            ### ğŸ“‹ Changes
            ${{ github.event.head_commit.message }}
            
          draft: false
          prerelease: false

  # åŒç«¯éƒ¨ç½²çŠ¶æ€é€šçŸ¥
  deployment-status:
    name: ğŸ“¢ Dual Deployment Status
    needs: [deploy-chrome-extension, deploy-serverless-backend]
    runs-on: ubuntu-latest
    if: always() && github.ref == 'refs/heads/main'
    
    steps:
      - name: ğŸ“Š Deployment Summary
        run: |
          echo "ğŸ“Š AcuityBookmarks Dual Deployment Summary"
          echo "========================================="
          echo "Commit: ${{ github.sha }}"
          echo "Branch: ${{ github.ref }}"
          echo "Timestamp: $(date)"
          echo ""
          
          CHROME_STATUS="${{ needs.deploy-chrome-extension.result }}"
          BACKEND_STATUS="${{ needs.deploy-serverless-backend.result }}"
          
          echo "ğŸ”— Chrome Extension Deployment: $CHROME_STATUS"
          echo "âš¡ Serverless Backend Deployment: $BACKEND_STATUS"
          echo ""
          
          if [ "$CHROME_STATUS" == "success" ] && [ "$BACKEND_STATUS" == "success" ]; then
            echo "âœ… ğŸ‰ COMPLETE SUCCESS!"
            echo "   - Chrome Extension: Published to Chrome Web Store"
            echo "   - Backend API: Live on Vercel Serverless"
            echo "   - Integration: Chrome Extension â†” Backend API"
            echo ""
            echo "ğŸš€ Your AcuityBookmarks is fully deployed!"
          elif [ "$CHROME_STATUS" == "success" ] || [ "$BACKEND_STATUS" == "success" ]; then
            echo "âš ï¸ ğŸ“¦ PARTIAL SUCCESS"
            echo "   One component deployed successfully, check the other"
            echo "   - Chrome Extension: $CHROME_STATUS"
            echo "   - Backend Services: $BACKEND_STATUS"
            echo ""
            echo "ğŸ”§ Manual intervention may be required"
          else
            echo "âŒ ğŸš¨ DEPLOYMENT FAILED"
            echo "   Both deployments failed, please check logs"
            echo "   - Chrome Extension: $CHROME_STATUS"  
            echo "   - Backend Services: $BACKEND_STATUS"
            echo ""
            echo "ğŸ“‹ Next steps: Review CI logs and fix issues"
            exit 1
          fi
