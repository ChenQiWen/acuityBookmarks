name = "acuitybookmarks"
main = "cloudflare-worker.js"
compatibility_date = "2024-10-01"
workers_dev = true

# 注意：Custom Domain 不支持路径/通配符，且本地开发无需 routes。
# 为避免 wrangler dev 校验失败，将自定义域名路由仅放在 production 环境里。

[env.production]
routes = [
  { pattern = "api.acuitybookmarks.com", custom_domain = true }
]

# 如果未来需要绑定 KV/R2/Durable Objects，可在此添加配置
[vars]
# 允许的 redirect_uri 前缀或来源（逗号分隔或 JSON 数组）。默认已允许 *.chromiumapp.org
#REDIRECT_URI_ALLOWLIST = "https://api.acuitybookmarks.com,https://localhost:8787"
# API_BASE = "https://api.example.com"

# ===================== 环境变量建议（部署前请在 Dashboard/Secrets 配置） =====================
# JWT_SECRET = "<high-entropy-production-secret>"
# SUPABASE_URL = "https://your-project.supabase.co"  # Supabase 项目 URL
# SUPABASE_SERVICE_ROLE_KEY = "<service-role-key>"  # Supabase Service Role Key（⚠️ 保密，只在后端使用）
# AUTH_GOOGLE_CLIENT_ID = "<optional>"
# AUTH_GOOGLE_CLIENT_SECRET = "<optional>"
# AUTH_GITHUB_CLIENT_ID = "<optional>"
# AUTH_GITHUB_CLIENT_SECRET = "<optional>"
# LEMON_SQUEEZY_API_KEY = "<optional>"
# LEMON_SQUEEZY_STORE_ID = "<optional>"
# LEMON_SQUEEZY_WEBHOOK_SECRET = "<optional>"

# 注意：D1 数据库已移除，已迁移到 Supabase
# 如果需要 D1，可以重新添加配置：
# [[d1_databases]]
# binding = "DB"
# database_name = "acuitybookmarks"
# database_id = "e7126c65-435c-40d2-b8a8-f0718a0fe16a"
# JWT_SECRET = "<high-entropy-production-secret>"
# SUPABASE_URL = "https://your-project.supabase.co"  # Supabase 项目 URL
# SUPABASE_SERVICE_ROLE_KEY = "<service-role-key>"  # Supabase Service Role Key（⚠️ 保密，只在后端使用）
# AUTH_GOOGLE_CLIENT_ID = "<optional>"
# AUTH_GOOGLE_CLIENT_SECRET = "<optional>"
# AUTH_GITHUB_CLIENT_ID = "<optional>"
# AUTH_GITHUB_CLIENT_SECRET = "<optional>"
# LEMON_SQUEEZY_API_KEY = "<optional>"
# LEMON_SQUEEZY_STORE_ID = "<optional>"
# LEMON_SQUEEZY_WEBHOOK_SECRET = "<optional>"

# 推荐域名规划（已采用）：
# - API: api.acuitybookmarks.com （本文件 routes 已设置）
# - App: app.acuitybookmarks.com （前端承载重置/设置等页面）

[ai]
binding = "AI"
remote = true

[[vectorize]]
binding = "VECTORIZE" # available in Worker as env.VECTORIZE
index_name = "bookmarks-index-m3" # 1024-dim index for @cf/baai/bge-m3
remote = true