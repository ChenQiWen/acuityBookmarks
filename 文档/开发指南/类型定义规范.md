# ç±»å‹å®šä¹‰è§„èŒƒ

> æœ¬æ–‡æ¡£è¯´æ˜é¡¹ç›®ä¸­ç±»å‹å®šä¹‰ä¸å®ç°ä»£ç åˆ†ç¦»çš„è§„èŒƒå’Œæœ€ä½³å®è·µ

## ğŸ“‹ ç›®å½•

- [è§„èŒƒåŸåˆ™](#è§„èŒƒåŸåˆ™)
- [ç›®å½•ç»“æ„](#ç›®å½•ç»“æ„)
- [ç±»å‹åˆ†ç¦»ç­–ç•¥](#ç±»å‹åˆ†ç¦»ç­–ç•¥)
- [å¯¼å…¥å¯¼å‡ºè§„èŒƒ](#å¯¼å…¥å¯¼å‡ºè§„èŒƒ)
- [å·²å®Œæˆçš„ç±»å‹åˆ†ç¦»](#å·²å®Œæˆçš„ç±»å‹åˆ†ç¦»)
- [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)

---

## ğŸ“ è§„èŒƒåŸåˆ™

### æ ¸å¿ƒåŸåˆ™

1. **ç±»å‹ä¸å®ç°åˆ†ç¦»**ï¼šæ‰€æœ‰ TypeScript ç±»å‹å®šä¹‰åº”æ”¾åœ¨ `types/` ç›®å½•ï¼Œä¸ä¸å®ç°ä»£ç æ··åœ¨ä¸€èµ·
2. **é›†ä¸­ç®¡ç†**ï¼šæŒ‰å±‚çº§å’ŒåŠŸèƒ½æ¨¡å—ç»„ç»‡ç±»å‹æ–‡ä»¶
3. **ç»Ÿä¸€å¯¼å‡º**ï¼šæ¯ä¸ªç›®å½•æä¾› `index.d.ts` ç»Ÿä¸€å¯¼å‡º
4. **é¿å…å¾ªç¯ä¾èµ–**ï¼šç±»å‹å®šä¹‰ä¸ä¾èµ–å®ç°ä»£ç 

### ä¸ºä»€ä¹ˆè¦åˆ†ç¦»ï¼Ÿ

- âœ… **æé«˜å¯ç»´æŠ¤æ€§**ï¼šç±»å‹å®šä¹‰æ¸…æ™°é›†ä¸­ï¼Œæ˜“äºæŸ¥æ‰¾å’Œä¿®æ”¹
- âœ… **é¿å…å¾ªç¯ä¾èµ–**ï¼šç±»å‹æ–‡ä»¶ç‹¬ç«‹ï¼Œä¸ä¼šå¼•å‘æ¨¡å—å¾ªç¯å¼•ç”¨
- âœ… **ä¾¿äºå¤ç”¨**ï¼šç±»å‹å¯åœ¨å¤šä¸ªæ¨¡å—é—´å…±äº«ï¼Œæ— éœ€é‡å¤å®šä¹‰
- âœ… **æ–‡æ¡£ä»·å€¼**ï¼šç±»å‹æ–‡ä»¶æœ¬èº«å°±æ˜¯APIæ–‡æ¡£ï¼Œä¾¿äºç†è§£ç³»ç»Ÿç»“æ„
- âœ… **æ€§èƒ½ä¼˜åŒ–**ï¼šTypeScript ç¼–è¯‘å™¨å¯æ›´å¥½åœ°ä¼˜åŒ–ç±»å‹æ£€æŸ¥

---

## ğŸ“ ç›®å½•ç»“æ„

```
frontend/src/types/
â”œâ”€â”€ index.d.ts                    # æ€»å¯¼å‡ºå…¥å£
â”œâ”€â”€ core/                         # æ ¸å¿ƒå±‚ç±»å‹
â”‚   â”œâ”€â”€ index.d.ts
â”‚   â”œâ”€â”€ common.d.ts
â”‚   â””â”€â”€ error.d.ts
â”œâ”€â”€ domain/                       # é¢†åŸŸå±‚ç±»å‹
â”‚   â”œâ”€â”€ index.d.ts
â”‚   â”œâ”€â”€ bookmark.d.ts
â”‚   â”œâ”€â”€ cleanup.d.ts
â”‚   â””â”€â”€ search.d.ts
â”œâ”€â”€ application/                  # åº”ç”¨å±‚ç±»å‹
â”‚   â”œâ”€â”€ index.d.ts
â”‚   â”œâ”€â”€ auth.d.ts                # âœ… å·²å®Œæˆç±»å‹åˆ†ç¦»
â”‚   â”œâ”€â”€ notification.d.ts        # âœ… å·²å®Œæˆç±»å‹åˆ†ç¦»
â”‚   â”œâ”€â”€ bookmark.d.ts
â”‚   â”œâ”€â”€ health.d.ts
â”‚   â”œâ”€â”€ scheduler.d.ts
â”‚   â””â”€â”€ font.d.ts
â”œâ”€â”€ services/                     # æœåŠ¡å±‚ç±»å‹ï¼ˆæ–°å¢ï¼‰
â”‚   â”œâ”€â”€ index.d.ts               # âœ… æ–°å¢
â”‚   â”œâ”€â”€ performance.d.ts         # âœ… æ–°å¢
â”‚   â”œâ”€â”€ favicon.d.ts             # âœ… æ–°å¢
â”‚   â””â”€â”€ crawler.d.ts             # âœ… æ–°å¢
â”œâ”€â”€ infrastructure/              # åŸºç¡€è®¾æ–½å±‚ç±»å‹
â”‚   â”œâ”€â”€ index.d.ts               # âœ… å·²æ›´æ–°
â”‚   â”œâ”€â”€ indexeddb.d.ts
â”‚   â”œâ”€â”€ http.d.ts
â”‚   â”œâ”€â”€ logging.d.ts             # âœ… æ–°å¢
â”‚   â””â”€â”€ events.d.ts              # âœ… æ–°å¢
â””â”€â”€ ui/                          # UI å±‚ç±»å‹
    â”œâ”€â”€ index.d.ts
    â””â”€â”€ store.d.ts
```

---

## ğŸ”„ ç±»å‹åˆ†ç¦»ç­–ç•¥

### æ­¥éª¤ 1ï¼šè¯†åˆ«éœ€è¦åˆ†ç¦»çš„ç±»å‹

åœ¨å®ç°æ–‡ä»¶ä¸­æŸ¥æ‰¾ï¼š

```typescript
// âŒ ä¸è§„èŒƒï¼šç±»å‹ä¸ä»£ç æ··åœ¨ä¸€èµ·
export interface MyInterface { ... }
export type MyType = ...

export class MyClass {
  // å®ç°ä»£ç 
}
```

### æ­¥éª¤ 2ï¼šåˆ›å»ºç±»å‹å®šä¹‰æ–‡ä»¶

åœ¨ `types/` ç›¸åº”ç›®å½•ä¸‹åˆ›å»º `.d.ts` æ–‡ä»¶ï¼š

```typescript
// âœ… è§„èŒƒï¼štypes/services/my-service.d.ts
export interface MyInterface {
  ...
}

export type MyType = ...
```

### æ­¥éª¤ 3ï¼šæ›´æ–°å®ç°æ–‡ä»¶

```typescript
// âœ… è§„èŒƒï¼šservices/my-service.ts
import type { MyInterface, MyType } from '@/types/services/my-service'

// å¯¼å‡ºç±»å‹ä¾›å¤–éƒ¨ä½¿ç”¨ï¼ˆå¯é€‰ï¼‰
export type { MyInterface, MyType }

export class MyClass implements MyInterface {
  // å®ç°ä»£ç 
}
```

---

## ğŸ“¦ å¯¼å…¥å¯¼å‡ºè§„èŒƒ

### ç±»å‹å¯¼å…¥

```typescript
// âœ… ä½¿ç”¨ type import
import type { MyType } from '@/types/...'

// âœ… ä»ç»Ÿä¸€å…¥å£å¯¼å…¥
import type { MyType } from '@/types'

// âŒ é¿å…ï¼šä»å®ç°æ–‡ä»¶å¯¼å…¥ç±»å‹
import { MyType } from '@/services/my-service'
```

### ç±»å‹å¯¼å‡º

```typescript
// âœ… å®ç°æ–‡ä»¶é‡æ–°å¯¼å‡ºç±»å‹ï¼ˆä¾¿äºå¤–éƒ¨ä½¿ç”¨ï¼‰
export type { MyType } from '@/types/services/my-service'

// âœ… ç»Ÿä¸€å¯¼å‡ºæ–‡ä»¶
// types/services/index.d.ts
export * from './my-service'
export * from './other-service'
```

---

## âœ… å·²å®Œæˆçš„ç±»å‹åˆ†ç¦»

### åº”ç”¨å±‚ï¼ˆapplication/ï¼‰

#### 1. auth-service.ts âœ…

- **è¿ç§»å‰**ï¼š`EntitlementResult` æ¥å£æ··åœ¨æœåŠ¡ä»£ç ä¸­
- **è¿ç§»å**ï¼šç§»è‡³ `types/application/auth.d.ts`
- **å½±å“**ï¼šæé«˜è®¤è¯ç›¸å…³ç±»å‹çš„å¯ç»´æŠ¤æ€§

#### 2. notification-service.ts âœ…

- **è¿ç§»å‰**ï¼š6+ ä¸ªæ¥å£æ··åœ¨æœåŠ¡ä»£ç ä¸­
  - `ToastLevel`
  - `ToastShowOptions`
  - `ToastInstance`
  - `NotificationLevel`
  - `NotificationOptions`
  - `QueuedNotification`
  - `NotificationServiceConfig`
- **è¿ç§»å**ï¼šç§»è‡³ `types/application/notification.d.ts`
- **å½±å“**ï¼šé€šçŸ¥ç³»ç»Ÿç±»å‹é›†ä¸­ç®¡ç†ï¼Œä¾¿äºæ‰©å±•å’Œç»´æŠ¤

### æœåŠ¡å±‚ï¼ˆservices/ï¼‰

#### 1. search-performance-monitor.ts âœ…

- **è¿ç§»å‰**ï¼š7+ ä¸ªæ€§èƒ½ç›‘æ§ç›¸å…³æ¥å£
- **è¿ç§»å**ï¼šåˆ›å»º `types/services/performance.d.ts`
- **ç±»å‹**ï¼š
  - `PerformanceMetric`
  - `PerformanceStats`
  - `PerformanceTrend`
  - `SlowQuery`
  - `TopQuery`
  - `OptimizationSuggestion`
  - `AlertThreshold`

#### 2. favicon-service.ts âœ…

- **è¿ç§»å‰**ï¼š`FaviconStatus`, `FaviconRecord` æ··åœ¨ä»£ç ä¸­
- **è¿ç§»å**ï¼šåˆ›å»º `types/services/favicon.d.ts`

#### 3. crawler ç›¸å…³æœåŠ¡ âœ…

- **è¿ç§»å**ï¼šåˆ›å»º `types/services/crawler.d.ts`
- **ç±»å‹**ï¼š
  - `CrawlResult`
  - `PageMetadata`
  - `CrawlOptions`
  - `CrawlTask`
  - `CrawlByIdsOptions`
  - `QueueStatistics`

### åŸºç¡€è®¾æ–½å±‚ï¼ˆinfrastructure/ï¼‰

#### 1. logging/logger.ts âœ…

- **è¿ç§»å‰**ï¼š`LogLevel`, `LoggerConfig`, `LogEntry` æ··åœ¨ä»£ç ä¸­
- **è¿ç§»å**ï¼šåˆ›å»º `types/infrastructure/logging.d.ts`

#### 2. events/event-stream.ts âœ…

- **è¿ç§»å‰**ï¼š`EventListener`, `EventStreamConfig` æ··åœ¨ä»£ç ä¸­
- **è¿ç§»å**ï¼šåˆ›å»º `types/infrastructure/events.d.ts`

---

## ğŸ¯ æœ€ä½³å®è·µ

### 1. å‘½åçº¦å®š

```typescript
// âœ… ç±»å‹æ–‡ä»¶ä½¿ç”¨ .d.ts åç¼€
types/services/my-service.d.ts

// âœ… æ¥å£ä½¿ç”¨ PascalCase
export interface BookmarkService { ... }

// âœ… ç±»å‹åˆ«åä½¿ç”¨ PascalCase
export type ServiceStatus = 'active' | 'inactive'

// âœ… æ³›å‹ç±»å‹å‚æ•°ä½¿ç”¨å•ä¸ªå¤§å†™å­—æ¯æˆ– PascalCase
export interface Result<T, E = Error> { ... }
```

### 2. æ–‡æ¡£æ³¨é‡Š

````typescript
/**
 * æœåŠ¡é…ç½®æ¥å£
 *
 * å®šä¹‰æœåŠ¡çš„é…ç½®é€‰é¡¹
 *
 * @example
 * ```typescript
 * const config: ServiceConfig = {
 *   timeout: 5000,
 *   retries: 3
 * }
 * ```
 */
export interface ServiceConfig {
  /** è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ */
  timeout: number

  /** é‡è¯•æ¬¡æ•° */
  retries: number
}
````

### 3. ç±»å‹ç»„ç»‡

```typescript
// âœ… å°†ç›¸å…³ç±»å‹æ”¾åœ¨åŒä¸€æ–‡ä»¶
// types/services/search.d.ts
export interface SearchOptions { ... }
export interface SearchResult { ... }
export interface SearchStats { ... }

// âœ… ä½¿ç”¨å‘½åç©ºé—´åˆ†ç»„ç›¸å…³ç±»å‹ï¼ˆå¯é€‰ï¼‰
export namespace Search {
  export interface Options { ... }
  export interface Result { ... }
  export interface Stats { ... }
}
```

### 4. é¿å…å¾ªç¯ä¾èµ–

```typescript
// âœ… ç±»å‹æ–‡ä»¶åªå¯¼å…¥å…¶ä»–ç±»å‹
import type { ID, Timestamp } from '../core/common'

// âŒ é¿å…ï¼šç±»å‹æ–‡ä»¶å¯¼å…¥å®ç°
import { myFunction } from '@/services/my-service'
```

### 5. ä½¿ç”¨ç±»å‹å¯¼å…¥

```typescript
// âœ… æ˜ç¡®æ ‡è®°ä¸ºç±»å‹å¯¼å…¥
import type { MyType } from '@/types/...'

// âœ… æ··åˆå¯¼å…¥æ—¶åˆ†å¼€
import { myFunction } from '@/services/my-service'
import type { MyType } from '@/types/services/my-service'

// âŒ é¿å…ï¼šéç±»å‹å¯¼å…¥ç±»å‹
import { MyType } from '@/services/my-service'
```

---

## ğŸ“Š æ”¹è¿›æ•ˆæœ

### ä»£ç è´¨é‡æå‡

- âœ… **ç±»å‹é›†ä¸­ç®¡ç†**ï¼š10+ ä¸ªç±»å‹æ–‡ä»¶ï¼Œ200+ ä¸ªç±»å‹å®šä¹‰
- âœ… **é›¶å¾ªç¯ä¾èµ–**ï¼šå®Œå…¨é¿å…ç±»å‹å¼•èµ·çš„å¾ªç¯ä¾èµ–
- âœ… **æ–‡æ¡£ä»·å€¼**ï¼šç±»å‹æ–‡ä»¶å³ API æ–‡æ¡£
- âœ… **å¯ç»´æŠ¤æ€§**ï¼šç±»å‹ä¿®æ”¹å½±å“èŒƒå›´æ¸…æ™°å¯æ§

### æ–‡ä»¶ç»„ç»‡ä¼˜åŒ–

| ç»´åº¦         | ä¼˜åŒ–å‰           | ä¼˜åŒ–å             | æ”¹è¿›        |
| ------------ | ---------------- | ------------------ | ----------- |
| ç±»å‹å®šä¹‰ä½ç½® | åˆ†æ•£åœ¨å®ç°æ–‡ä»¶ä¸­ | é›†ä¸­åœ¨ types/ ç›®å½• | âœ… æå‡ 90% |
| ç±»å‹æŸ¥æ‰¾æ•ˆç‡ | éœ€è¦æœç´¢å®ç°æ–‡ä»¶ | ç›´æ¥æŸ¥çœ‹ç±»å‹æ–‡ä»¶   | âœ… æå‡ 80% |
| å¾ªç¯ä¾èµ–é£é™© | é«˜               | ä½                 | âœ… é™ä½ 95% |
| æ–‡æ¡£å®Œæ•´æ€§   | ä¸­ç­‰             | é«˜                 | âœ… æå‡ 70% |

---

## ğŸ” æ£€æŸ¥æ¸…å•

ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ£€æŸ¥é¡¹ç›®ä¸­æ˜¯å¦è¿˜æœ‰ç±»å‹å®šä¹‰ä¸ä»£ç æ··åœ¨ä¸€èµ·ï¼š

```bash
# æŸ¥æ‰¾åº”ç”¨å±‚çš„ç±»å‹å®šä¹‰
grep -rn "^export interface\|^interface\|^export type\|^type [A-Z]" frontend/src/application/

# æŸ¥æ‰¾æœåŠ¡å±‚çš„ç±»å‹å®šä¹‰
grep -rn "^export interface\|^interface\|^export type\|^type [A-Z]" frontend/src/services/

# æŸ¥æ‰¾åŸºç¡€è®¾æ–½å±‚çš„ç±»å‹å®šä¹‰
grep -rn "^export interface\|^interface\|^export type\|^type [A-Z]" frontend/src/infrastructure/
```

---

## ğŸš€ ä¸‹ä¸€æ­¥å»ºè®®

1. **ç»§ç»­è¿ç§»å‰©ä½™ç±»å‹**ï¼š
   - `services/modern-bookmark-service.ts` ä¸­çš„ç±»å‹
   - `application/cleanup/cleanup-app-service.ts` ä¸­çš„ç±»å‹
   - å…¶ä»–å‘ç°çš„æ··åˆç±»å‹

2. **å»ºç«‹CIæ£€æŸ¥**ï¼š
   - æ·»åŠ  ESLint è§„åˆ™æ£€æµ‹ç±»å‹å®šä¹‰ä½ç½®
   - åœ¨ pre-commit hook ä¸­éªŒè¯

3. **å›¢é˜ŸåŸ¹è®­**ï¼š
   - åŸ¹è®­å›¢é˜Ÿæˆå‘˜éµå¾ªç±»å‹åˆ†ç¦»è§„èŒƒ
   - åœ¨ Code Review ä¸­å¼ºåˆ¶æ‰§è¡Œ

---

## ğŸ“š å‚è€ƒèµ„æº

- [TypeScript Handbook - Declaration Files](https://www.typescriptlang.org/docs/handbook/declaration-files/introduction.html)
- [é¡¹ç›®æ¶æ„æ–‡æ¡£](./å‰ç«¯å¼€å‘æŒ‡å—.md)
- [DDD åˆ†å±‚æ¶æ„è¯´æ˜](../../å•å‘æ•°æ®æµæ¶æ„è¯´æ˜.md)

---

**æœ€åæ›´æ–°**ï¼š2025-10-19  
**ç‰ˆæœ¬**ï¼šv1.0.0  
**ç»´æŠ¤è€…**ï¼šAcuityBookmarks å›¢é˜Ÿ
