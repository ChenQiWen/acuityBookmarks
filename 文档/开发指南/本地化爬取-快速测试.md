# æœ¬åœ°åŒ–çˆ¬å– - 5åˆ†é’Ÿå¿«é€Ÿæµ‹è¯• âš¡

## ğŸ¯ ç›®æ ‡

**ç”¨æœ€å¿«çš„æ–¹å¼éªŒè¯çˆ¬å–åŠŸèƒ½æ˜¯å¦æ­£å¸¸å·¥ä½œï¼**

---

## ğŸ“‹ å‰ç½®æ¡ä»¶

1. âœ… å·²è¿è¡Œ `npm run build`
2. âœ… å·²åœ¨ Chrome ä¸­åŠ è½½æ‰©å±•ï¼ˆ`chrome://extensions`ï¼‰
3. âœ… Chrome ä¸­æœ‰ä¸€äº›ä¹¦ç­¾

---

## ğŸš€ 5åˆ†é’Ÿæµ‹è¯•æµç¨‹

### æ­¥éª¤ 1: æ‰“å¼€æ§åˆ¶å°ï¼ˆ30ç§’ï¼‰

1. ç‚¹å‡» Chrome æ‰©å±•å›¾æ ‡
2. ç‚¹å‡» "ç®¡ç†ä¹¦ç­¾" æˆ– "Management"
3. æŒ‰ `F12` æ‰“å¼€å¼€å‘è€…å·¥å…·
4. åˆ‡æ¢åˆ° "Console" æ ‡ç­¾

### æ­¥éª¤ 2: å¯¼å…¥æµ‹è¯•å·¥å…·ï¼ˆ30ç§’ï¼‰

åœ¨æ§åˆ¶å°ç²˜è´´å¹¶æ‰§è¡Œï¼š

```javascript
// å¿«é€Ÿå¯¼å…¥çˆ¬å–å·¥å…·
const crawlerModule = await import('./assets/app-services.CvlJmFwV.js')
const { crawlSingleBookmark, getCrawlStatistics, getBookmarkMetadata } =
  crawlerModule

// å¿«é€Ÿè·å–ä¸€ä¸ªæµ‹è¯•ä¹¦ç­¾
const testBookmarks = await chrome.bookmarks.search({})
const testBookmark = testBookmarks.find(b => b.url)

console.log('âœ… æµ‹è¯•å·¥å…·å·²åŠ è½½')
console.log('ğŸ“š æµ‹è¯•ä¹¦ç­¾:', testBookmark?.title, testBookmark?.url)
```

**âš ï¸ æ³¨æ„**ï¼šå¦‚æœåœ¨ Service Worker æ§åˆ¶å°æµ‹è¯•ï¼Œä¸è¦ä½¿ç”¨ `window` å¯¹è±¡ï¼š

```javascript
// âŒ é”™è¯¯ï¼ˆService Worker æ²¡æœ‰ windowï¼‰
const crawler = window.bookmarkCrawler

// âœ… æ­£ç¡®ï¼ˆä½¿ç”¨ self æˆ– globalThisï¼‰
const crawler = self.bookmarkCrawler
// æˆ–
const crawler = globalThis.bookmarkCrawler
```

### æ­¥éª¤ 3: æµ‹è¯•å•ä¸ªçˆ¬å–ï¼ˆ1åˆ†é’Ÿï¼‰

```javascript
// çˆ¬å–æµ‹è¯•ä¹¦ç­¾
console.log('ğŸš€ å¼€å§‹çˆ¬å–...')
await crawlSingleBookmark(testBookmark, { priority: 'high' })

console.log('âœ… çˆ¬å–å®Œæˆï¼')
```

**é¢„æœŸçœ‹åˆ°**ï¼š

```
ğŸš€ å¼€å§‹çˆ¬å–...
[LocalCrawler] ğŸ” å¼€å§‹çˆ¬å–ä¹¦ç­¾: GitHub
[LocalCrawler] âœ… çˆ¬å–æˆåŠŸ
âœ… çˆ¬å–å®Œæˆï¼
```

### æ­¥éª¤ 4: éªŒè¯ç»“æœï¼ˆ1åˆ†é’Ÿï¼‰

```javascript
// è·å–çˆ¬å–çš„å…ƒæ•°æ®
const metadata = await getBookmarkMetadata(testBookmark.id)

console.log('ğŸ“Š çˆ¬å–ç»“æœ:')
console.log('  æ ‡é¢˜:', metadata?.pageTitle)
console.log('  æè¿°:', metadata?.description)
console.log('  å…³é”®è¯:', metadata?.keywords)
console.log('  çŠ¶æ€:', metadata?.status)
console.log('  HTTPçŠ¶æ€:', metadata?.httpStatus)
```

**é¢„æœŸçœ‹åˆ°**ï¼š

```
ğŸ“Š çˆ¬å–ç»“æœ:
  æ ‡é¢˜: GitHub: Let's build from here
  æè¿°: GitHub is where over 100 million developers...
  å…³é”®è¯: github, code, repository, git
  çŠ¶æ€: success
  HTTPçŠ¶æ€: 200
```

### æ­¥éª¤ 5: æŸ¥çœ‹ç»Ÿè®¡ï¼ˆ30ç§’ï¼‰

```javascript
// æŸ¥çœ‹æ•´ä½“ç»Ÿè®¡
const stats = await getCrawlStatistics()

console.log('ğŸ“ˆ ç»Ÿè®¡ä¿¡æ¯:')
console.log('  æ€»è®¡:', stats.total)
console.log('  å·²çˆ¬å–:', stats.withMetadata)
console.log('  å¤±è´¥:', stats.failed)
console.log(
  '  æˆåŠŸç‡:',
  (((stats.withMetadata - stats.failed) / stats.total) * 100).toFixed(1) + '%'
)
```

**é¢„æœŸçœ‹åˆ°**ï¼š

```
ğŸ“ˆ ç»Ÿè®¡ä¿¡æ¯:
  æ€»è®¡: 1
  å·²çˆ¬å–: 1
  å¤±è´¥: 0
  æˆåŠŸç‡: 100.0%
```

---

## âœ… æˆåŠŸæ ‡å¿—

å¦‚æœä½ çœ‹åˆ°ä»¥ä¸‹å†…å®¹ï¼Œè¯´æ˜çˆ¬å–åŠŸèƒ½**å®Œå…¨æ­£å¸¸**ï¼š

- âœ… æ— é”™è¯¯ä¿¡æ¯
- âœ… `metadata.status` = "success"
- âœ… `metadata.pageTitle` æœ‰å†…å®¹
- âœ… `metadata.httpStatus` = 200
- âœ… ç»Ÿè®¡ä¿¡æ¯æ­£ç¡®

---

## ğŸ¯ è¿›é˜¶æµ‹è¯•ï¼ˆå¯é€‰ï¼‰

### æ‰¹é‡æµ‹è¯• 10 ä¸ªä¹¦ç­¾

```javascript
// è·å– 10 ä¸ªä¹¦ç­¾
const batch = testBookmarks.filter(b => b.url).slice(0, 10)

console.log(`ğŸ“š å‡†å¤‡æµ‹è¯• ${batch.length} ä¸ªä¹¦ç­¾`)

// å¯¼å…¥æ‰¹é‡çˆ¬å–
const { crawlMultipleBookmarks } = crawlerModule

// æ‰¹é‡çˆ¬å–
await crawlMultipleBookmarks(batch, {
  priority: 'normal',
  onProgress: (done, total) => {
    console.log(`ğŸ“Š è¿›åº¦: ${done}/${total}`)
  },
  onComplete: results => {
    const success = results.filter(r => r.success).length
    console.log(`âœ… å®Œæˆ: ${success}/${results.length}`)
  }
})

// å†æ¬¡æŸ¥çœ‹ç»Ÿè®¡
const newStats = await getCrawlStatistics()
console.log('ğŸ“ˆ æ›´æ–°åç»Ÿè®¡:', newStats)
```

---

## ğŸ› é‡åˆ°é—®é¢˜ï¼Ÿ

### é—®é¢˜ 1: `Cannot find module` é”™è¯¯

**åŸå› **: èµ„æºæ–‡ä»¶åå¯èƒ½ä¸åŒ

**è§£å†³**:

```javascript
// æ–¹å¼ A: ä½¿ç”¨ç›¸å¯¹è·¯å¾„
const crawlerModule = await import('../services/local-bookmark-crawler.js')

// æ–¹å¼ B: åœ¨ Service Worker ä¸­æµ‹è¯•
// chrome://extensions â†’ Service Worker â†’ Console
```

### é—®é¢˜ 2: çˆ¬å–æ²¡æœ‰ååº”

**æ£€æŸ¥ Offscreen Document**:

```javascript
const hasOffscreen = await chrome.offscreen.hasDocument()
console.log('Offscreen å­˜åœ¨:', hasOffscreen)

// å¦‚æœä¸å­˜åœ¨ï¼Œæ‰‹åŠ¨åˆ›å»º
if (!hasOffscreen) {
  const { createOffscreenDocument } = await import('./page-fetcher.js')
  await createOffscreenDocument()
  console.log('âœ… Offscreen Document å·²åˆ›å»º')
}
```

### é—®é¢˜ 3: æ•°æ®æ²¡æœ‰ä¿å­˜

**æ‰‹åŠ¨æ£€æŸ¥ IndexedDB**:

```javascript
const { indexedDBManager } = await import(
  './infrastructure/indexeddb/manager.js'
)
await indexedDBManager.initialize()

const allMeta = await indexedDBManager.getAllCrawlMetadata()
console.log('ğŸ“Š å·²ä¿å­˜çš„å…ƒæ•°æ®æ•°é‡:', allMeta.length)
console.log('ğŸ“„ ç¤ºä¾‹æ•°æ®:', allMeta[0])
```

---

## ğŸ“ å¿«æ·æµ‹è¯•å‘½ä»¤

å¤åˆ¶ç²˜è´´æ•´æ®µä»£ç ï¼Œä¸€æ¬¡æ€§å®Œæˆæ‰€æœ‰æµ‹è¯•ï¼š

```javascript
;(async function quickTest() {
  console.log('ğŸ§ª å¼€å§‹å¿«é€Ÿæµ‹è¯•...\n')

  try {
    // 1. å¯¼å…¥æ¨¡å—
    console.log('1ï¸âƒ£ å¯¼å…¥æ¨¡å—...')
    const { crawlSingleBookmark, getCrawlStatistics, getBookmarkMetadata } =
      await import('./assets/app-services.CvlJmFwV.js')

    // 2. è·å–æµ‹è¯•ä¹¦ç­¾
    console.log('2ï¸âƒ£ è·å–æµ‹è¯•ä¹¦ç­¾...')
    const bookmarks = await chrome.bookmarks.search({})
    const testBookmark = bookmarks.find(b => b.url)

    if (!testBookmark) {
      console.error('âŒ æ²¡æœ‰æ‰¾åˆ°å¯æµ‹è¯•çš„ä¹¦ç­¾')
      return
    }

    console.log(`   ğŸ“š ${testBookmark.title} - ${testBookmark.url}`)

    // 3. çˆ¬å–
    console.log('\n3ï¸âƒ£ å¼€å§‹çˆ¬å–...')
    const startTime = Date.now()
    await crawlSingleBookmark(testBookmark, { priority: 'high' })
    const duration = Date.now() - startTime
    console.log(`   â±ï¸ è€—æ—¶: ${duration}ms`)

    // 4. éªŒè¯ç»“æœ
    console.log('\n4ï¸âƒ£ éªŒè¯ç»“æœ...')
    const metadata = await getBookmarkMetadata(testBookmark.id)

    if (metadata) {
      console.log('   âœ… æ ‡é¢˜:', metadata.pageTitle)
      console.log('   âœ… æè¿°:', metadata.description?.substring(0, 50) + '...')
      console.log('   âœ… çŠ¶æ€:', metadata.status)
      console.log('   âœ… HTTP:', metadata.httpStatus)
    } else {
      console.error('   âŒ æœªæ‰¾åˆ°å…ƒæ•°æ®')
    }

    // 5. ç»Ÿè®¡
    console.log('\n5ï¸âƒ£ ç»Ÿè®¡ä¿¡æ¯...')
    const stats = await getCrawlStatistics()
    console.log('   ğŸ“Š æ€»è®¡:', stats.total)
    console.log('   ğŸ“Š æˆåŠŸ:', stats.withMetadata)
    console.log('   ğŸ“Š å¤±è´¥:', stats.failed)

    // ç»“è®º
    console.log('\n' + '='.repeat(50))
    if (metadata && metadata.status === 'success') {
      console.log('ğŸ‰ æµ‹è¯•é€šè¿‡ï¼çˆ¬å–åŠŸèƒ½æ­£å¸¸å·¥ä½œï¼')
    } else {
      console.log('âš ï¸ æµ‹è¯•æœªå®Œå…¨é€šè¿‡ï¼Œè¯·æ£€æŸ¥é”™è¯¯ä¿¡æ¯')
    }
    console.log('='.repeat(50))
  } catch (error) {
    console.error('âŒ æµ‹è¯•å¤±è´¥:', error)
    console.error('é”™è¯¯è¯¦æƒ…:', error.stack)
  }
})()
```

---

## â±ï¸ é¢„è®¡æ—¶é—´

| æ­¥éª¤       | æ—¶é—´        | ç´¯è®¡    |
| ---------- | ----------- | ------- |
| æ‰“å¼€æ§åˆ¶å° | 30ç§’        | 30ç§’    |
| å¯¼å…¥å·¥å…·   | 30ç§’        | 1åˆ†é’Ÿ   |
| å•ä¸ªçˆ¬å–   | 1åˆ†é’Ÿ       | 2åˆ†é’Ÿ   |
| éªŒè¯ç»“æœ   | 1åˆ†é’Ÿ       | 3åˆ†é’Ÿ   |
| æŸ¥çœ‹ç»Ÿè®¡   | 30ç§’        | 3.5åˆ†é’Ÿ |
| **æ€»è®¡**   | **3.5åˆ†é’Ÿ** |         |

---

## ğŸ“ ä¸‹ä¸€æ­¥

æµ‹è¯•é€šè¿‡åï¼Œä½ å¯ä»¥ï¼š

1. ğŸ“– é˜…è¯» [å®Œæ•´æµ‹è¯•æŒ‡å—](./æœ¬åœ°åŒ–çˆ¬å–-æµ‹è¯•æŒ‡å—.md)
2. ğŸ”§ é…ç½® [è‡ªåŠ¨çˆ¬å–è§¦å‘](./æœ¬åœ°åŒ–çˆ¬å–-é›†æˆæŒ‡å—.md)
3. ğŸš€ è¿›è¡Œ [å¤§æ‰¹é‡æ€§èƒ½æµ‹è¯•](./æœ¬åœ°åŒ–çˆ¬å–-æµ‹è¯•æŒ‡å—.md#åœºæ™¯-5-æ€§èƒ½æµ‹è¯•å¤§æ‰¹é‡)

---

**ç¥æµ‹è¯•é¡ºåˆ©ï¼** ğŸ‰
