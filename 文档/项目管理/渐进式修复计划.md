# ğŸ¯ æ¸è¿›å¼Bugä¿®å¤å’Œæ¶æ„æ”¹è¿›è®¡åˆ’

## ğŸ“Š å½“å‰é—®é¢˜ä¸¥é‡ç¨‹åº¦åˆ†çº§

åŸºäºæˆ‘ä»¬çš„è°ƒè¯•ç»éªŒï¼Œå°†é—®é¢˜æŒ‰å½±å“ç¨‹åº¦åˆ†ç±»ï¼š

### ğŸ”¥ **P0çº§åˆ« - æ ¸å¿ƒåŠŸèƒ½å®Œå…¨å¤±æ•ˆï¼ˆç«‹å³ä¿®å¤ï¼‰**
- âŒ **é‡å‘½åæ–‡ä»¶å¤¹ååº”ç”¨ä¸ç”Ÿæ•ˆ** - é˜»ç¢åŸºæœ¬æ“ä½œ
- âŒ **ä¸€é”®æ¸…ç†åˆ é™¤æ‰€æœ‰ä¹¦ç­¾è€Œä¸æ˜¯ç›®æ ‡ä¹¦ç­¾** - æ•°æ®å®‰å…¨é—®é¢˜  
- âŒ **æ‹–æ‹½é‡æ’åºååº”ç”¨ä¸ç”Ÿæ•ˆ** - æ ¸å¿ƒåŠŸèƒ½å¤±æ•ˆ

### âš ï¸ **P1çº§åˆ« - åŠŸèƒ½éƒ¨åˆ†å¼‚å¸¸ï¼ˆæœ¬å‘¨ä¿®å¤ï¼‰**
- ğŸ› **å±•å¼€/æŠ˜å çŠ¶æ€æ··ä¹±å¯¼è‡´æ˜¾ç¤ºé”™è¯¯** - å½±å“ç”¨æˆ·ä½“éªŒ
- ğŸ› **ç­›é€‰åˆ‡æ¢åæ•°æ®æ˜¾ç¤ºé”™è¯¯** - åŠŸèƒ½é€»è¾‘é—®é¢˜
- ğŸ› **å¤æ‚åº¦è®¡ç®—æ— æ³•æ£€æµ‹æ‹–æ‹½å˜åŒ–** - è¾…åŠ©åŠŸèƒ½å¼‚å¸¸

### ğŸ“ **P2çº§åˆ« - ä½“éªŒä¼˜åŒ–ï¼ˆåç»­å¤„ç†ï¼‰**
- ğŸ¨ **æŒ‰é’®åœ†è§’è¿‡å¤§æ ·å¼é—®é¢˜** - è§†è§‰ä½“éªŒ
- ğŸ“Š **çŠ¶æ€åŒæ­¥å»¶è¿Ÿå¯¼è‡´ç•Œé¢é—ªçƒ** - æ€§èƒ½ä¼˜åŒ–

## ğŸš€ **ä¸‰é˜¶æ®µæ¸è¿›å¼ä¿®å¤ç­–ç•¥**

### **ç¬¬1é˜¶æ®µï¼šç´§æ€¥ä¿®å¤æ ¸å¿ƒåŠŸèƒ½ï¼ˆ3-5å¤©ï¼‰**
**ç›®æ ‡**ï¼šæ¢å¤åŸºæœ¬å¯ç”¨æ€§ï¼Œè§£å†³ç”¨æˆ·æœ€ç—›çš„é—®é¢˜

#### 1.1 ä¿®å¤é‡å‘½ååŠŸèƒ½
```typescript
// é—®é¢˜ï¼šfinishEditingä¸­çš„æ•°æ®æ›´æ–°æ–¹å¼é”™è¯¯
// è§£å†³ï¼šç¡®ä¿æ­£ç¡®æ›´æ–°storeå¹¶è§¦å‘å“åº”å¼æ›´æ–°

// å½“å‰é—®é¢˜ä»£ç ï¼š
props.node.title = newTitle // âŒ ç›´æ¥ä¿®æ”¹props

// ä¿®å¤åï¼š
await managementStore.updateNodeInProposal(props.node.id, { title: newTitle })
```

#### 1.2 ä¿®å¤æ¸…ç†åŠŸèƒ½ç²¾å‡†åˆ é™¤
```typescript
// é—®é¢˜ï¼šexecuteCleanupåˆ é™¤äº†æ‰€æœ‰æ£€æµ‹åˆ°çš„é—®é¢˜ï¼Œè€Œéå¯è§çš„
// è§£å†³ï¼šåªåˆ é™¤å½“å‰ç­›é€‰æ˜¾ç¤ºçš„é—®é¢˜ä¹¦ç­¾

// ä¿®å¤æ ¸å¿ƒé€»è¾‘ï¼šåŸºäºlegendVisibilityè¿‡æ»¤è¦åˆ é™¤çš„ä¹¦ç­¾
const visibleProblems = filterResults.filter(problem => 
  cleanupState.legendVisibility[problem.type]
)
```

#### 1.3 ä¿®å¤æ‹–æ‹½åº”ç”¨åŠŸèƒ½
```typescript
// é—®é¢˜ï¼šapplyAllBookmarkChangesæ²¡æœ‰æ­£ç¡®å¤„ç†é‡æ’åº
// è§£å†³ï¼šä½¿ç”¨chrome.bookmarks.move APIæ­£ç¡®å¤„ç†é¡ºåºå˜æ›´

// æ ¸å¿ƒä¿®å¤ï¼šç¡®ä¿æ‹–æ‹½åçš„æ•°æ®æ­£ç¡®ä¿å­˜åˆ°store
managementStore.newProposalTree = newOrderedTree // è§¦å‘å“åº”å¼æ›´æ–°
```

### **ç¬¬2é˜¶æ®µï¼šæ¶æ„æ ¸å¿ƒæ”¹è¿›ï¼ˆ1å‘¨ï¼‰**
**ç›®æ ‡**ï¼šè§£å†³æ•°æ®åŒæ­¥æ ¹æœ¬é—®é¢˜ï¼Œé¢„é˜²æœªæ¥Bug

#### 2.1 å®ç°ç»Ÿä¸€çŠ¶æ€æ›´æ–°æœºåˆ¶
```typescript
// åˆ›å»ºä¸“é—¨çš„çŠ¶æ€æ›´æ–°æ–¹æ³•ï¼Œé¿å…ç›´æ¥ä¿®æ”¹æ•°æ®
const useBookmarkMutations = () => {
  const updateNode = (nodeId: string, updates: Partial<BookmarkNode>) => {
    // ä¸å¯å˜æ›´æ–°æ¨¡å¼
    managementStore.newProposalTree = updateNodeImmutable(
      managementStore.newProposalTree, 
      nodeId, 
      updates
    )
    // å¼ºåˆ¶è§¦å‘å“åº”å¼æ›´æ–°
    nextTick(() => triggerReactivityUpdate())
  }
  
  return { updateNode }
}
```

#### 2.2 Vueå“åº”å¼é™·é˜±è§£å†³
```typescript
// é—®é¢˜ï¼šæ·±å±‚åµŒå¥—å¯¹è±¡å˜æ›´ä¸è¢«æ£€æµ‹
// è§£å†³ï¼šä½¿ç”¨å®Œæ•´å¯¹è±¡æ›¿æ¢è€Œéå±€éƒ¨ä¿®æ”¹

// âŒ é—®é¢˜æ–¹å¼
newProposalTree.value.children[0].title = 'new title'

// âœ… æ­£ç¡®æ–¹å¼  
newProposalTree.value = {
  ...newProposalTree.value,
  children: newProposalTree.value.children.map(child => 
    child.id === targetId ? {...child, title: 'new title'} : child
  )
}
```

#### 2.3 çŠ¶æ€å˜åŒ–è¿½è¸ªç³»ç»Ÿ
```typescript
// æ·»åŠ çŠ¶æ€å˜åŒ–ç›‘æ§å’Œè°ƒè¯•
const stateTracker = {
  logChange: (action: string, before: any, after: any) => {
    console.log(`ğŸ”„ [${action}] çŠ¶æ€å˜åŒ–:`, {
      timestamp: Date.now(),
      before: JSON.stringify(before).slice(0, 100),
      after: JSON.stringify(after).slice(0, 100)
    })
  }
}
```

### **ç¬¬3é˜¶æ®µï¼šç¨³å®šæ€§ä¼˜åŒ–ï¼ˆ3-5å¤©ï¼‰**
**ç›®æ ‡**ï¼šè§£å†³å‰©ä½™é—®é¢˜ï¼Œæå‡æ•´ä½“ç¨³å®šæ€§

#### 3.1 å±•å¼€çŠ¶æ€ç®¡ç†ä¼˜åŒ–
```typescript
// ç»Ÿä¸€ç®¡ç†æ‰€æœ‰å±•å¼€çŠ¶æ€ï¼Œé¿å…çŠ¶æ€ä¸ä¸€è‡´
const useExpandedState = () => {
  const toggleExpanded = (folderId: string) => {
    managementStore.proposalExpandedFolders = new Set(
      managementStore.proposalExpandedFolders.has(folderId)
        ? [...managementStore.proposalExpandedFolders].filter(id => id !== folderId)
        : [...managementStore.proposalExpandedFolders, folderId]
    )
  }
  
  return { toggleExpanded }
}
```

#### 3.2 é”™è¯¯å¤„ç†å’Œæ¢å¤æœºåˆ¶
```typescript
// æ·»åŠ æ“ä½œå¤±è´¥çš„å›æ»šæœºåˆ¶
const safeUpdateWithRollback = async (updateFn: Function) => {
  const backup = JSON.parse(JSON.stringify(managementStore.newProposalTree))
  try {
    await updateFn()
  } catch (error) {
    // å›æ»šåˆ°å¤‡ä»½çŠ¶æ€
    managementStore.newProposalTree = backup
    console.error('æ“ä½œå¤±è´¥ï¼Œå·²å›æ»š:', error)
    throw error
  }
}
```

## ğŸ“‹ **å…·ä½“æ‰§è¡Œæ—¶é—´è¡¨**

### **æœ¬å‘¨**
- **å‘¨ä¸€-å‘¨äºŒ**: P0çº§åˆ«Bugä¿®å¤ï¼ˆé‡å‘½åã€æ¸…ç†ã€æ‹–æ‹½ï¼‰
- **å‘¨ä¸‰-å‘¨å››**: éªŒè¯ä¿®å¤æ•ˆæœï¼Œè¡¥å……é—æ¼é—®é¢˜
- **å‘¨äº”**: P1çº§åˆ«Bugä¿®å¤ï¼ˆçŠ¶æ€ç®¡ç†é—®é¢˜ï¼‰

### **ä¸‹å‘¨**
- **å‘¨ä¸€-å‘¨ä¸‰**: æ¶æ„æ ¸å¿ƒæ”¹è¿›ï¼ˆçŠ¶æ€æ›´æ–°æœºåˆ¶ï¼‰
- **å‘¨å››-å‘¨äº”**: ç¨³å®šæ€§ä¼˜åŒ–å’Œæµ‹è¯•éªŒè¯

### **ç¬¬ä¸‰å‘¨** 
- **å‘¨ä¸€-å‘¨äºŒ**: å‰©ä½™é—®é¢˜ä¿®å¤å’Œä¼˜åŒ–
- **å‘¨ä¸‰-å‘¨äº”**: å…¨é¢æµ‹è¯•å’Œæ–‡æ¡£æ›´æ–°

## âœ… **åˆ¤æ–­æ ‡å‡†ï¼šä½•æ—¶åœæ­¢Bugä¿®å¤è½¬å‘æ¶æ„é‡æ„**

å¦‚æœåœ¨ç¬¬1é˜¶æ®µç»“æŸåï¼š
- âœ… **P0é—®é¢˜è§£å†³ç‡ > 90%** â†’ ç»§ç»­æ¸è¿›å¼æ”¹è¿›
- âŒ **P0é—®é¢˜è§£å†³ç‡ < 70%** â†’ è€ƒè™‘å¤§è§„æ¨¡æ¶æ„é‡æ„

å¦‚æœåœ¨ç¬¬2é˜¶æ®µç»“æŸåï¼š
- âœ… **æ–°Bugå‡ºç°é¢‘ç‡å¤§å¹…ä¸‹é™** â†’ å½“å‰ç­–ç•¥æœ‰æ•ˆ
- âŒ **ä¾ç„¶é¢‘ç¹å‡ºç°æ–°çš„æ•°æ®åŒæ­¥é—®é¢˜** â†’ è€ƒè™‘Reactè¿ç§»

## ğŸ¯ **ç«‹å³è¡ŒåŠ¨è®¡åˆ’**

**ä»Šå¤©å°±å¼€å§‹**ï¼š
1. ğŸ”¥ ä¿®å¤é‡å‘½åä¸ç”Ÿæ•ˆçš„Bugï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
2. ğŸ”¥ ä¿®å¤æ¸…ç†åŠŸèƒ½ç²¾å‡†åˆ é™¤é—®é¢˜
3. ğŸ“Š å»ºç«‹Bugä¿®å¤æ•ˆæœè¿½è¸ªæœºåˆ¶

**è¿™æ ·åšçš„ä¼˜åŠ¿**ï¼š
- ğŸ’ª **ç”¨æˆ·ç«‹å³å—ç›Š**ï¼šæ ¸å¿ƒåŠŸèƒ½æ¢å¤æ­£å¸¸
- ğŸ”§ **ç§¯ç´¯æ”¹è¿›ç»éªŒ**ï¼šä¸ºæ¶æ„ä¼˜åŒ–æä¾›å‚è€ƒ  
- ğŸ“ˆ **é£é™©å¯æ§**ï¼šæ¯ä¸ªé˜¶æ®µéƒ½æœ‰æ˜ç¡®çš„æˆåŠŸæ ‡å‡†
- âš¡ **å¿«é€Ÿåé¦ˆ**ï¼šèƒ½åŠæ—¶è°ƒæ•´ç­–ç•¥æ–¹å‘

## ğŸ’¡ **å…³é”®å†³ç­–åŸåˆ™**

**ä¼˜å…ˆä¿®å¤é‚£äº›å½±å“å¤šä¸ªåŠŸèƒ½çš„åº•å±‚é—®é¢˜**ï¼Œè€Œä¸æ˜¯è¡¨é¢çš„ç‹¬ç«‹Bugã€‚ä»æˆ‘ä»¬çš„ç»éªŒæ¥çœ‹ï¼Œæ•°æ®åŒæ­¥å’ŒVueå“åº”å¼æ˜¯æœ€æ ¸å¿ƒçš„æ¶æ„é—®é¢˜ï¼Œè§£å†³äº†è¿™äº›é—®é¢˜ï¼Œå¾ˆå¤šè¡¨é¢Bugä¼šè‡ªç„¶æ¶ˆå¤±ã€‚
