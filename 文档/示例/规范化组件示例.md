# 📦 规范化组件示例

> 完整的组件开发示例，展示如何创建符合规范的组件

---

## 示例 1: 基础 UI 组件 - Badge

### 1. 创建组件

```bash
./frontend/scripts/create-base-component.sh Badge
```

### 2. 组件实现 (`Badge.vue`)

```vue
<!--
  📦 Badge - 徽章组件
  
  功能：显示小标签或徽章，用于标记状态、数量等
  分类：基础 UI 组件
  依赖：无
-->

<script setup lang="ts">
import type { BadgeProps } from './Badge.types'

const props = withDefaults(defineProps<BadgeProps>(), {
  variant: 'default',
  size: 'md',
  rounded: true
})

// 计算样式类名
const badgeClasses = computed(() => [
  'badge',
  `badge--${props.variant}`,
  `badge--${props.size}`,
  {
    'badge--rounded': props.rounded,
    'badge--dot': props.dot
  }
])
</script>

<template>
  <span v-if="!dot" :class="badgeClasses">
    <slot />
  </span>
  <span v-else :class="badgeClasses" aria-label="状态指示器"></span>
</template>

<style scoped>
.badge {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: var(--badge-font-size, 12px);
  font-weight: 500;
  line-height: 1;
  white-space: nowrap;
  transition: all 0.2s;
}

/* 尺寸 */
.badge--sm {
  padding: 2px 6px;
  font-size: 10px;
  min-height: 16px;
}

.badge--md {
  padding: 4px 8px;
  font-size: 12px;
  min-height: 20px;
}

.badge--lg {
  padding: 6px 12px;
  font-size: 14px;
  min-height: 24px;
}

/* 变体 */
.badge--default {
  background: var(--color-surface-variant);
  color: var(--color-on-surface-variant);
}

.badge--primary {
  background: var(--color-primary);
  color: var(--color-on-primary);
}

.badge--success {
  background: var(--color-success);
  color: var(--color-on-success);
}

.badge--warning {
  background: var(--color-warning);
  color: var(--color-on-warning);
}

.badge--error {
  background: var(--color-error);
  color: var(--color-on-error);
}

/* 圆角 */
.badge--rounded {
  border-radius: 12px;
}

/* 点状徽章 */
.badge--dot {
  width: 8px;
  height: 8px;
  padding: 0;
  border-radius: 50%;
}
</style>
```

### 3. 类型定义 (`Badge.types.ts`)

```typescript
/**
 * 📦 Badge - 徽章组件类型定义
 */

/**
 * 组件 Props
 */
export interface BadgeProps {
  /**
   * 徽章变体
   * @default 'default'
   */
  variant?: 'default' | 'primary' | 'success' | 'warning' | 'error'

  /**
   * 徽章尺寸
   * @default 'md'
   */
  size?: 'sm' | 'md' | 'lg'

  /**
   * 是否圆角
   * @default true
   */
  rounded?: boolean

  /**
   * 是否显示为点状（无内容）
   * @default false
   */
  dot?: boolean
}

/**
 * 组件 Emits
 */
export interface BadgeEmits {
  // 无事件
}
```

### 4. 使用文档 (`README.md`)

```markdown
# Badge

## 📋 概述

徽章组件，用于显示标签、状态指示器或计数。

## 📦 分类

- [x] 基础 UI 组件
- [ ] 复合组件

## 🎯 使用场景

- 显示未读消息数量
- 标记新功能或新内容
- 显示状态（成功、警告、错误）
- 作为标签分类内容

## 📖 API

### Props

| 属性名    | 类型                                                          | 默认值      | 必填 | 描述           |
| --------- | ------------------------------------------------------------- | ----------- | ---- | -------------- |
| `variant` | `'default' \| 'primary' \| 'success' \| 'warning' \| 'error'` | `'default'` | 否   | 徽章变体       |
| `size`    | `'sm' \| 'md' \| 'lg'`                                        | `'md'`      | 否   | 徽章尺寸       |
| `rounded` | `boolean`                                                     | `true`      | 否   | 是否圆角       |
| `dot`     | `boolean`                                                     | `false`     | 否   | 是否显示为点状 |

### Slots

| 插槽名    | Props | 描述     |
| --------- | ----- | -------- |
| `default` | -     | 徽章内容 |

## 💡 使用示例

### 基础使用

\`\`\`vue
<template>

  <div>
    <!-- 默认徽章 -->
    <Badge>New</Badge>
    
    <!-- 主要徽章 -->
    <Badge variant="primary">99+</Badge>
    
    <!-- 成功徽章 -->
    <Badge variant="success">已完成</Badge>
    
    <!-- 警告徽章 -->
    <Badge variant="warning">待处理</Badge>
    
    <!-- 错误徽章 -->
    <Badge variant="error">错误</Badge>
  </div>
</template>

<script setup lang="ts">
import { Badge } from '@/components'
</script>

\`\`\`

### 不同尺寸

\`\`\`vue
<template>

  <div>
    <Badge size="sm">Small</Badge>
    <Badge size="md">Medium</Badge>
    <Badge size="lg">Large</Badge>
  </div>
</template>
\`\`\`

### 点状徽章（状态指示器）

\`\`\`vue
<template>

  <div style="display: flex; align-items: center; gap: 8px;">
    <Badge variant="success" dot />
    <span>在线</span>
  </div>
</template>
\`\`\`

### 与其他组件组合

\`\`\`vue
<template>
<Button>
消息
<Badge variant="error" size="sm">5</Badge>
</Button>
</template>
\`\`\`

## 🎨 样式定制

### CSS 变量

| 变量名               | 默认值 | 描述             |
| -------------------- | ------ | ---------------- |
| `--badge-font-size`  | `12px` | 字体大小         |
| `--color-primary`    | 主题色 | 主要变体背景色   |
| `--color-on-primary` | 白色   | 主要变体文字颜色 |

### 示例

\`\`\`css
.custom-badge {
--badge-font-size: 14px;
}
\`\`\`

## 📦 依赖组件

无

## ⚠️ 注意事项

- 徽章内容应简短，通常不超过 3 个字符
- 使用点状徽章时，确保有适当的 aria-label
- 数量超过 99 时，建议显示为 "99+"

## 🔄 更新日志

### v1.0.0 (2025-10-14)

- 初始版本
```

### 5. 导出组件

在 `components/index.ts` 中添加：

```typescript
export { default as Badge } from './base/Badge/Badge.vue'
export type * from './base/Badge/Badge.types'
```

---

## 示例 2: 复合组件 - SearchPanel

### 1. 创建组件

```bash
./frontend/scripts/create-composite-component.sh SearchPanel
```

### 2. 组件实现 (`SearchPanel.vue`)

```vue
<!--
  📦 SearchPanel - 搜索面板
  
  功能：提供书签搜索功能，包含搜索输入、结果显示和筛选
  分类：复合组件
  依赖：Input, Icon, List, Badge
-->

<script setup lang="ts">
import { ref, computed, inject } from 'vue'
import { Input, Icon, List, Badge } from '@/components'
import type { SearchAppService } from '@/application/search/search-app-service'
import type { SearchPanelProps, SearchPanelEmits } from './SearchPanel.types'

const props = withDefaults(defineProps<SearchPanelProps>(), {
  placeholder: '搜索书签...',
  showCount: true
})

const emit = defineEmits<SearchPanelEmits>()

// 注入搜索服务
const searchApp = inject<SearchAppService>('searchApp')

// 状态
const query = ref('')
const results = ref([])
const isSearching = ref(false)

// 计算属性
const hasResults = computed(() => results.value.length > 0)
const resultCount = computed(() => results.value.length)

// 搜索方法
const handleSearch = async (searchQuery: string) => {
  if (!searchQuery.trim()) {
    results.value = []
    return
  }

  isSearching.value = true

  try {
    // 通过应用服务执行搜索
    const searchResults = await searchApp?.search(searchQuery)
    results.value = searchResults || []

    // 发送搜索完成事件
    emit('search', searchQuery, results.value)
  } catch (error) {
    console.error('搜索失败:', error)
    results.value = []
  } finally {
    isSearching.value = false
  }
}

// 选择结果
const handleSelectResult = (item: any) => {
  emit('select', item)
}

// 清空搜索
const handleClear = () => {
  query.value = ''
  results.value = []
  emit('clear')
}
</script>

<template>
  <div class="search-panel">
    <!-- 搜索输入 -->
    <div class="search-panel__input">
      <Input
        v-model="query"
        :placeholder="placeholder"
        @input="handleSearch(query)"
        @clear="handleClear"
      >
        <template #prefix>
          <Icon name="mdi-magnify" />
        </template>
      </Input>
    </div>

    <!-- 结果计数 -->
    <div v-if="showCount && hasResults" class="search-panel__count">
      找到 <Badge variant="primary" size="sm">{{ resultCount }}</Badge> 个结果
    </div>

    <!-- 搜索结果 -->
    <div class="search-panel__results">
      <List v-if="hasResults" :items="results" @item-click="handleSelectResult">
        <template #item="{ item }">
          <slot name="result" :item="item">
            {{ item.title }}
          </slot>
        </template>
      </List>

      <!-- 空状态 -->
      <div v-else-if="query && !isSearching" class="search-panel__empty">
        <Icon name="mdi-magnify-close" :size="48" />
        <p>没有找到匹配的结果</p>
      </div>

      <!-- 加载状态 -->
      <div v-else-if="isSearching" class="search-panel__loading">
        <Icon name="mdi-loading" :size="24" spin />
        搜索中...
      </div>
    </div>
  </div>
</template>

<style scoped>
.search-panel {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.search-panel__input {
  /* 输入框样式 */
}

.search-panel__count {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 14px;
  color: var(--color-on-surface-variant);
}

.search-panel__results {
  min-height: 200px;
}

.search-panel__empty {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 40px 20px;
  color: var(--color-on-surface-variant);
  text-align: center;
}

.search-panel__loading {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  padding: 40px 20px;
  color: var(--color-on-surface-variant);
}
</style>
```

### 3. 类型定义 (`SearchPanel.types.ts`)

```typescript
/**
 * 📦 SearchPanel - 搜索面板类型定义
 */

/**
 * 组件 Props
 */
export interface SearchPanelProps {
  /**
   * 搜索框占位符
   * @default '搜索书签...'
   */
  placeholder?: string

  /**
   * 是否显示结果计数
   * @default true
   */
  showCount?: boolean
}

/**
 * 组件 Emits
 */
export interface SearchPanelEmits {
  /**
   * 搜索完成事件
   * @param query - 搜索关键词
   * @param results - 搜索结果
   */
  (event: 'search', query: string, results: any[]): void

  /**
   * 选择结果事件
   * @param item - 选中的项目
   */
  (event: 'select', item: any): void

  /**
   * 清空搜索事件
   */
  (event: 'clear'): void
}

/**
 * 搜索结果项
 */
export interface SearchResultItem {
  id: string
  title: string
  url?: string
  [key: string]: any
}
```

### 4. 使用示例

```vue
<template>
  <SearchPanel
    placeholder="搜索我的书签..."
    :show-count="true"
    @search="handleSearch"
    @select="handleSelectBookmark"
    @clear="handleClear"
  >
    <!-- 自定义结果显示 -->
    <template #result="{ item }">
      <div class="bookmark-result">
        <img :src="item.favicon" alt="" class="favicon" />
        <div class="info">
          <div class="title">{{ item.title }}</div>
          <div class="url">{{ item.url }}</div>
        </div>
      </div>
    </template>
  </SearchPanel>
</template>

<script setup lang="ts">
import { SearchPanel } from '@/components'

const handleSearch = (query: string, results: any[]) => {
  console.log(`搜索 "${query}"，找到 ${results.length} 个结果`)
}

const handleSelectBookmark = (item: any) => {
  console.log('选中书签:', item)
  // 打开书签或其他操作
}

const handleClear = () => {
  console.log('清空搜索')
}
</script>
```

---

## 关键要点总结

### 基础组件开发

1. ✅ **无业务逻辑** - 纯展示，完全受控
2. ✅ **完整的类型定义** - Props, Emits, Expose
3. ✅ **详细的文档** - API 说明和使用示例
4. ✅ **CSS 变量支持** - 方便样式定制
5. ✅ **无障碍支持** - aria-label 等

### 复合组件开发

1. ✅ **通过 inject 获取服务** - 不直接访问底层 API
2. ✅ **组合基础组件** - 复用已有的 UI 组件
3. ✅ **提供插槽** - 允许自定义内容
4. ✅ **发送语义化事件** - 让父组件知道发生了什么
5. ✅ **处理加载和错误状态** - 良好的用户体验

---

**开始创建你的规范化组件吧！** 🚀
